<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora Pedi√°trica </title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #dbeafe 0%, #e0e7ff 100%);
            min-height: 100vh;
            padding: 24px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2563eb 0%, #4f46e5 100%);
            color: white;
            padding: 24px;
        }

        .header h1 {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .header p {
            color: #bfdbfe;
            font-size: 14px;
        }

        .navigation {
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            padding: 0 24px;
        }

        .nav-button {
            padding: 16px 8px;
            border: none;
            background: none;
            border-bottom: 2px solid transparent;
            cursor: pointer;
            font-weight: 500;
            font-size: 14px;
            color: #6b7280;
            margin-right: 32px;
            transition: all 0.2s;
        }

        .nav-button.active {
            color: #2563eb;
            border-bottom-color: #2563eb;
        }

        .nav-button:hover {
            color: #374151;
        }

        .content {
            padding: 24px;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .grid {
            display: grid;
            gap: 32px;
        }

        .grid-2 {
            grid-template-columns: 1fr 1fr;
        }

        .grid-3 {
            grid-template-columns: repeat(3, 1fr);
        }

        .card {
            background: white;
            padding: 24px;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .card-blue {
            background: #eff6ff;
            border-left: 4px solid #2563eb;
        }

        .card-green {
            background: #f0fdf4;
            border-left: 4px solid #16a34a;
        }

        .input-group {
            margin-bottom: 16px;
        }

        .label {
            display: block;
            font-weight: 500;
            color: #374151;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .input, .select {
            width: 100%;
            padding: 12px;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.2s;
        }

        .input:focus, .select:focus {
            outline: none;
            border-color: #2563eb;
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .button {
            padding: 12px 16px;
            border: none;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .button-primary {
            background: #2563eb;
            color: white;
        }

        .button-primary:hover {
            background: #1d4ed8;
        }

        .button-green {
            background: #16a34a;
            color: white;
        }

        .button-green:hover {
            background: #15803d;
        }

        .button-red {
            background: #dc2626;
            color: white;
        }

        .button-red:hover {
            background: #b91c1c;
        }

        .result-card {
            background: #f9fafb;
            border-left: 4px solid #2563eb;
            padding: 24px;
            border-radius: 8px;
            margin-bottom: 16px;
        }

        .result-title {
            font-size: 18px;
            font-weight: bold;
            color: #374151;
            margin-bottom: 16px;
        }

        .result-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            margin-bottom: 16px;
        }

        .result-item {
            text-align: center;
        }

        .result-value {
            font-size: 32px;
            font-weight: bold;
            color: #2563eb;
        }

        .result-label {
            font-size: 14px;
            color: #6b7280;
        }

        .warning-card {
            background: #fef2f2;
            border-left: 4px solid #dc2626;
            padding: 16px;
            margin: 16px 0;
        }

        .warning-title {
            font-weight: 500;
            color: #991b1b;
            margin-bottom: 4px;
        }

        .warning-text {
            color: #b91c1c;
            font-size: 14px;
        }

        .info-card {
            background: #fef3c7;
            border-left: 4px solid #f59e0b;
            padding: 16px;
            margin: 16px 0;
        }

        .search-box {
            position: relative;
            margin-bottom: 24px;
        }

        .search-input {
            padding-left: 40px;
        }

        .search-icon {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: #9ca3af;
        }

        .medication-card {
            background: white;
            padding: 24px;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
            transition: all 0.2s;
        }

        .medication-card:hover {
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .medication-header {
            display: flex;
            justify-content: between;
            align-items: start;
            margin-bottom: 12px;
        }

        .medication-name {
            font-weight: bold;
            color: #374151;
        }

        .medication-category {
            background: #dbeafe;
            color: #1d4ed8;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
        }

        .scale-item {
            background: #f9fafb;
            border: 2px solid transparent;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: start;
            gap: 12px;
        }

        .scale-item:hover {
            background: #f3f4f6;
        }

        .scale-item.selected {
            background: #eff6ff;
            border-color: #93c5fd;
        }

        .scale-item input {
            margin-top: 4px;
        }

        .scale-content {
            flex: 1;
        }

        .scale-text {
            font-size: 14px;
            color: #374151;
            margin-bottom: 4px;
        }

        .scale-points {
            background: #e5e7eb;
            color: #374151;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }

        .score-display {
            text-align: center;
            padding: 24px;
        }

        .score-number {
            font-size: 48px;
            font-weight: bold;
            color: #2563eb;
            margin-bottom: 8px;
        }

        .score-max {
            font-size: 14px;
            color: #6b7280;
        }

        .interpretation {
            padding: 12px;
            border-radius: 8px;
            margin-top: 16px;
            border: 2px solid;
        }

        .interpretation.green {
            background: #f0fdf4;
            color: #166534;
            border-color: #bbf7d0;
        }

        .interpretation.yellow {
            background: #fefce8;
            color: #854d0e;
            border-color: #fde047;
        }

        .interpretation.orange {
            background: #fff7ed;
            color: #9a3412;
            border-color: #fed7aa;
        }

        .interpretation.red {
            background: #fef2f2;
            color: #991b1b;
            border-color: #fecaca;
        }

        .interpretation-level {
            font-weight: bold;
            font-size: 14px;
        }

        .interpretation-desc {
            font-size: 12px;
            margin-top: 4px;
        }

        .footer {
            margin-top: 32px;
            text-align: center;
            font-size: 14px;
            color: #6b7280;
            line-height: 1.6;
        }

        .advice-content {
            white-space: pre-wrap;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            font-size: 14px;
            line-height: 1.6;
            color: #374151;
        }

        @media (max-width: 768px) {
            .grid-2, .grid-3 {
                grid-template-columns: 1fr;
            }
            
            .navigation {
                flex-wrap: wrap;
            }
            
            .nav-button {
                margin-right: 16px;
                margin-bottom: 8px;
            }
        }

        .hidden {
            display: none;
        }

        .back-button {
            background: none;
            border: none;
            color: #6b7280;
            cursor: pointer;
            font-size: 14px;
            margin-bottom: 16px;
        }

        .back-button:hover {
            color: #374151;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>üßÆ Calculadora Pedi√°trica Avanzada</h1>
            <p>Herramienta integral para el manejo farmacol√≥gico y evaluaci√≥n cl√≠nica pedi√°trica</p>
        </div>

        <!-- Navigation -->
        <div class="navigation">
            <button class="nav-button active" onclick="showTab('calculator')">üßÆ Calculadora</button>
            <button class="nav-button" onclick="showTab('scales')">üìä Escalas Cl√≠nicas</button>
            <button class="nav-button" onclick="showTab('vademecum')">üìö Vadem√©cum</button>
            <button class="nav-button" onclick="showTab('advice')">‚ù§Ô∏è Consejos Padres</button>
        </div>

        <!-- Content -->
        <div class="content">
            <!-- Calculator Tab -->
            <div id="calculator" class="tab-content active">
                <div class="grid grid-2">
                    <!-- Input Section -->
                    <div>
                        <div class="card card-blue">
                            <h2 class="result-title">üßÆ Datos del Paciente</h2>
                            
                            <div class="input-group">
                                <label class="label">Peso del ni√±o (kg)</label>
                                <input type="number" id="weight" class="input" placeholder="Ej: 15.5" step="0.1" min="0.5" max="100" oninput="updateCalculations()">
                            </div>

                            <div class="input-group">
                                <label class="label">Seleccionar medicamento</label>
                                <select id="medication" class="select" onchange="updateCalculations()">
                                    <option value="">-- Seleccionar medicamento --</option>
                                    <optgroup label="ü¶† Antibi√≥ticos">
                                        <option value="amoxicilina">Amoxicilina</option>
                                        <option value="amoxicilina_clavulanico">Amoxicilina-Clavul√°nico</option>
                                        <option value="azitromicina">Azitromicina</option>
                                        <option value="claritromicina">Claritromicina</option>
                                        <option value="cefalexina">Cefalexina</option>
                                        <option value="cefixima">Cefixima</option>
                                        <option value="eritromicina">Eritromicina</option>
                                        <option value="ceftriaxona">Ceftriaxona (hospitalaria)</option>
                                    </optgroup>
                                    <optgroup label="üå°Ô∏è Analg√©sicos/Antipir√©ticos">
                                        <option value="paracetamol">Paracetamol</option>
                                        <option value="ibuprofeno">Ibuprofeno</option>
                                        <option value="metamizol">Metamizol (Nolotil)</option>
                                        <option value="paracetamol_supositorios">Paracetamol supositorios</option>
                                    </optgroup>
                                    <optgroup label="üíä Corticoides">
                                        <option value="prednisolona">Prednisolona</option>
                                        <option value="dexametasona">Dexametasona</option>
                                        <option value="hidrocortisona">Hidrocortisona</option>
                                    </optgroup>
                                    <optgroup label="ü´Å Broncodilatadores">
                                        <option value="salbutamol">Salbutamol</option>
                                        <option value="terbutalina">Terbutalina</option>
                                    </optgroup>
                                    <optgroup label="ü§ß Antihistam√≠nicos">
                                        <option value="cetirizina">Cetirizina</option>
                                        <option value="loratadina">Loratadina</option>
                                        <option value="hidroxicina">Hidroxicina (sedante)</option>
                                    </optgroup>
                                    <optgroup label="ü§¢ Antiem√©ticos">
                                        <option value="domperidona">Domperidona</option>
                                        <option value="ondansetron">Ondansetr√≥n</option>
                                        <option value="metoclopramida">Metoclopramida</option>
                                    </optgroup>
                                    <optgroup label="üí® Mucol√≠ticos/Expectorantes">
                                        <option value="mucosolvan">Ambroxol (Mucosolvan)</option>
                                        <option value="acetilcisteina">Acetilciste√≠na</option>
                                    </optgroup>
                                    <optgroup label="üõ°Ô∏è Protectores G√°stricos">
                                        <option value="omeprazol">Omeprazol</option>
                                        <option value="lansoprazol">Lansoprazol</option>
                                    </optgroup>
                                    <optgroup label="üí© Laxantes">
                                        <option value="lactulosa">Lactulosa</option>
                                        <option value="macrogol">Macrogol (Movicol)</option>
                                    </optgroup>
                                    <optgroup label="ü¶† Probi√≥ticos">
                                        <option value="lactobacillus">Lactobacillus rhamnosus</option>
                                    </optgroup>
                                    <optgroup label="üíß Rehidrataci√≥n">
                                        <option value="sro">Suero Rehidrataci√≥n Oral</option>
                                    </optgroup>
                                    <optgroup label="üß¥ T√≥picos">
                                        <option value="fluticasona">Fluticasona nasal</option>
                                        <option value="betametasona">Betametasona t√≥pica</option>
                                    </optgroup>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Results Section -->
                    <div>
                        <div id="results-card" class="card hidden">
                            <h2 class="result-title">‚úÖ Resultado del C√°lculo</h2>
                            
                            <div class="result-card">
                                <h3 id="selected-med-name" class="medication-name"></h3>
                                <div class="result-grid">
                                    <div class="result-item">
                                        <p class="result-label">Dosis calculada:</p>
                                        <p class="result-value" id="calculated-mg">0 mg</p>
                                    </div>
                                    <div class="result-item">
                                        <p class="result-label">Volumen a administrar:</p>
                                        <p class="result-value" id="calculated-ml">0 ml</p>
                                    </div>
                                </div>
                                
                                <div style="background: #fef3c7; border-left: 4px solid #f59e0b; padding: 8px; margin: 12px 0; border-radius: 4px;">
                                    <p style="font-size: 11px; color: #92400e; margin: 0;">
                                        <strong>‚ö†Ô∏è</strong> Volumen calculado para la presentaci√≥n especificada. Verificar concentraci√≥n en envase.
                                    </p>
                                </div>
                                
                                <div id="medication-details"></div>
                            </div>

                            <div id="medication-warnings"></div>
                        </div>

                        <!-- Automatic Analgesic Calculation -->
                        <div id="analgesics-card" class="card card-green hidden">
                            <h3 class="result-title">‚ù§Ô∏è Analg√©sicos Autom√°ticos (por peso)</h3>
                            
                            <div style="background: #fef3c7; border-left: 4px solid #f59e0b; padding: 12px; margin-bottom: 16px; border-radius: 6px;">
                                <p style="font-size: 12px; color: #92400e; margin: 0;">
                                    <strong>‚ö†Ô∏è IMPORTANTE:</strong> Verificar SIEMPRE la concentraci√≥n en el envase del medicamento antes de administrar.
                                </p>
                            </div>
                            
                            <div class="grid grid-2">
                                <div class="card">
                                    <h4 class="medication-name">Paracetamol</h4>
                                    <div style="margin-bottom: 12px;">
                                        <p style="font-size: 12px; color: #6b7280;">Jarabe 160mg/5ml (32mg/ml):</p>
                                        <p class="result-value" id="paracetamol-jarabe-ml" style="color: #16a34a;">0 ml</p>
                                    </div>
                                    <div style="margin-bottom: 12px;">
                                        <p style="font-size: 12px; color: #6b7280;">Gotas 100mg/ml (concentrado):</p>
                                        <p class="result-value" id="paracetamol-gotas-ml" style="color: #16a34a;">0 ml</p>
                                    </div>
                                    <p class="result-label">Cada 4-6 horas (m√°x 5 dosis/d√≠a)</p>
                                </div>
                                
                                <div class="card">
                                    <h4 class="medication-name">Ibuprofeno</h4>
                                    <div style="margin-bottom: 12px;">
                                        <p style="font-size: 12px; color: #6b7280;">Jarabe 100mg/5ml (20mg/ml):</p>
                                        <p class="result-value" id="ibuprofeno-jarabe-ml" style="color: #2563eb;">0 ml</p>
                                    </div>
                                    <div style="margin-bottom: 12px;">
                                        <p style="font-size: 12px; color: #6b7280;">Gotas 200mg/ml (CONCENTRADO):</p>
                                        <p class="result-value" id="ibuprofeno-concentrado-ml" style="color: #2563eb;">0 ml</p>
                                    </div>
                                    <p class="result-label">Cada 6-8 horas (>6 meses)</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Scales Tab -->
            <div id="scales" class="tab-content">
                <h2 class="result-title">üìä Escalas Cl√≠nicas Pedi√°tricas</h2>
                
                <div id="scales-list">
                    <div class="grid grid-3">
                        <div class="medication-card">
                            <div class="medication-header">
                                <h3 class="medication-name">üß† Escala de Glasgow Pedi√°trica</h3>
                            </div>
                            <p style="color: #6b7280; font-size: 14px; margin-bottom: 16px;">Evaluaci√≥n del nivel de conciencia en ni√±os</p>
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <span style="font-size: 12px; color: #6b7280;">Max: 15 puntos</span>
                                <button class="button button-primary" onclick="showScale('glasgow')">Evaluar</button>
                            </div>
                        </div>

                        <div class="medication-card">
                            <div class="medication-header">
                                <h3 class="medication-name">ü´Å Escala de Silverman-Andersen</h3>
                            </div>
                            <p style="color: #6b7280; font-size: 14px; margin-bottom: 16px;">Evaluaci√≥n de dificultad respiratoria neonatal</p>
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <span style="font-size: 12px; color: #6b7280;">Max: 10 puntos</span>
                                <button class="button button-primary" onclick="showScale('silverman')">Evaluar</button>
                            </div>
                        </div>

                        <div class="medication-card">
                            <div class="medication-header">
                                <h3 class="medication-name">üåä Wood-Downes-Ferr√©s</h3>
                            </div>
                            <p style="color: #6b7280; font-size: 14px; margin-bottom: 16px;">Evaluaci√≥n de gravedad en bronquiolitis</p>
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <span style="font-size: 12px; color: #6b7280;">Max: 15 puntos</span>
                                <button class="button button-primary" onclick="showScale('wood_downes')">Evaluar</button>
                            </div>
                        </div>

                        <div class="medication-card">
                            <div class="medication-header">
                                <h3 class="medication-name">‚ö†Ô∏è PEWS</h3>
                            </div>
                            <p style="color: #6b7280; font-size: 14px; margin-bottom: 16px;">Predicci√≥n de deterioro cl√≠nico pedi√°trico</p>
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <span style="font-size: 12px; color: #6b7280;">Max: 9 puntos</span>
                                <button class="button button-primary" onclick="showScale('pews')">Evaluar</button>
                            </div>
                        </div>

                        <div class="medication-card">
                            <div class="medication-header">
                                <h3 class="medication-name">üé≠ Escala de Westley</h3>
                            </div>
                            <p style="color: #6b7280; font-size: 14px; margin-bottom: 16px;">Evaluaci√≥n de gravedad del crup/laringitis</p>
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <span style="font-size: 12px; color: #6b7280;">Max: 17 puntos</span>
                                <button class="button button-primary" onclick="showScale('westley')">Evaluar</button>
                            </div>
                        </div>
                    </div>
                </div>

                <h3 style="margin: 32px 0 16px 0; color: #374151; font-size: 20px;">üå°Ô∏è Escalas de Evaluaci√≥n de Fiebre</h3>
                <div class="grid grid-2">
                    <div class="medication-card">
                        <div class="medication-header">
                            <h3 class="medication-name">üå°Ô∏è Fiebre Pedi√°trica General</h3>
                        </div>
                        <p style="color: #6b7280; font-size: 14px; margin-bottom: 16px;">Evaluaci√≥n de riesgo en ni√±os con fiebre</p>
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span style="font-size: 12px; color: #6b7280;">Max: 12 puntos</span>
                            <button class="button button-primary" onclick="showScale('fiebre')">Evaluar</button>
                        </div>
                    </div>

                    <div class="medication-card">
                        <div class="medication-header">
                            <h3 class="medication-name">üë∂ Young Infant (YIOS)</h3>
                        </div>
                        <p style="color: #6b7280; font-size: 14px; margin-bottom: 16px;">Lactantes febriles 1-3 meses</p>
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span style="font-size: 12px; color: #6b7280;">Max: 18 puntos</span>
                            <button class="button button-primary" onclick="showScale('young_infant')">Evaluar</button>
                        </div>
                    </div>

                    <div class="medication-card">
                        <div class="medication-header">
                            <h3 class="medication-name">üéØ Yale Observation (YOS)</h3>
                        </div>
                        <p style="color: #6b7280; font-size: 14px; margin-bottom: 16px;">Ni√±os febriles 3-36 meses</p>
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span style="font-size: 12px; color: #6b7280;">Max: 18 puntos</span>
                            <button class="button button-primary" onclick="showScale('yale_observation')">Evaluar</button>
                        </div>
                    </div>

                    <div class="medication-card">
                        <div class="medication-header">
                            <h3 class="medication-name">üö® Sepsis Pedi√°trica</h3>
                        </div>
                        <p style="color: #6b7280; font-size: 14px; margin-bottom: 16px;">Criterios de sepsis/shock s√©ptico</p>
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span style="font-size: 12px; color: #6b7280;">Max: 15 puntos</span>
                            <button class="button button-primary" onclick="showScale('sepsis_pediatrica')">Evaluar</button>
                        </div>
                    </div>
                    </div>
                </div>

                <div id="scale-evaluation" class="hidden">
                    <button class="back-button" onclick="backToScales()">‚Üê Volver a escalas</button>
                    
                    <div class="grid grid-3">
                        <!-- Evaluation Area -->
                        <div style="grid-column: span 2;">
                            <div class="card">
                                <h4 class="result-title">üìã Evaluaci√≥n</h4>
                                <div id="scale-categories"></div>
                            </div>
                        </div>

                        <!-- Results Area -->
                        <div>
                            <!-- Score -->
                            <div class="card">
                                <h4 class="result-title">üéØ Puntuaci√≥n</h4>
                                <div class="score-display">
                                    <div class="score-number" id="current-score">0</div>
                                    <div class="score-max">de <span id="max-score">0</span> puntos</div>
                                </div>
                                <div id="interpretation-result"></div>
                            </div>

                            <!-- Actions -->
                            <div class="card">
                                <h4 class="result-title">üé¨ Acciones</h4>
                                <div style="display: flex; flex-direction: column; gap: 12px;">
                                    <button class="button button-green" onclick="copyScaleReport()" id="copy-report-btn">
                                        üìÑ Copiar Informe
                                    </button>
                                    <button class="button button-red" onclick="clearCurrentScale()">
                                        üóëÔ∏è Limpiar
                                    </button>
                                </div>
                            </div>

                            <!-- Instructions -->
                            <div class="info-card">
                                <div style="display: flex; align-items: start;">
                                    <span style="color: #f59e0b; margin-right: 8px;">‚ÑπÔ∏è</span>
                                    <div style="font-size: 14px; color: #92400e;">
                                        <p style="font-weight: 500; margin-bottom: 4px;">Instrucciones:</p>
                                        <ul style="font-size: 12px; line-height: 1.4;">
                                            <li>‚Ä¢ Marque los hallazgos encontrados</li>
                                            <li>‚Ä¢ La puntuaci√≥n se calcula autom√°ticamente</li>
                                            <li>‚Ä¢ Use "Copiar Informe" para pegar en historia cl√≠nica</li>
                                            <li>‚Ä¢ El informe incluye fecha, hora e interpretaci√≥n</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Vademecum Tab -->
            <div id="vademecum" class="tab-content">
                <h2 class="result-title">üìö Vadem√©cum Pedi√°trico</h2>
                
                <div class="search-box">
                    <span class="search-icon">üîç</span>
                    <input type="text" class="input search-input" placeholder="Buscar medicamento..." id="search-medication" oninput="filterMedications()">
                </div>

                <div id="medications-grid" class="grid grid-3">
                    <!-- Medications will be populated by JavaScript -->
                </div>
            </div>

            <!-- Advice Tab -->
            <div id="advice" class="tab-content">
                <h2 class="result-title">‚ù§Ô∏è Consejos para Padres</h2>
                
                <div id="advice-list">
                    <div class="grid grid-3">
                        <div class="medication-card">
                            <div class="medication-header">
                                <h3 class="medication-name">üíß Manejo de la Gastroenteritis Aguda</h3>
                            </div>
                            <div style="display: flex; flex-direction: column; gap: 12px; margin-top: 16px;">
                                <button class="button button-primary" onclick="showAdvice('gastroenteritis')">üìÑ Ver Gu√≠a Completa</button>
                                <button class="button button-green" onclick="printAdvice('gastroenteritis')">üñ®Ô∏è Imprimir Gu√≠a</button>
                            </div>
                        </div>

                        <div class="medication-card">
                            <div class="medication-header">
                                <h3 class="medication-name">üå°Ô∏è Manejo de la Fiebre en Ni√±os</h3>
                            </div>
                            <div style="display: flex; flex-direction: column; gap: 12px; margin-top: 16px;">
                                <button class="button button-primary" onclick="showAdvice('fiebre')">üìÑ Ver Gu√≠a Completa</button>
                                <button class="button button-green" onclick="printAdvice('fiebre')">üñ®Ô∏è Imprimir Gu√≠a</button>
                            </div>
                        </div>

                        <div class="medication-card">
                            <div class="medication-header">
                                <h3 class="medication-name">üõ°Ô∏è Administraci√≥n Segura de Medicamentos</h3>
                            </div>
                            <div style="display: flex; flex-direction: column; gap: 12px; margin-top: 16px;">
                                <button class="button button-primary" onclick="showAdvice('administracion_medicamentos')">üìÑ Ver Gu√≠a Completa</button>
                                <button class="button button-green" onclick="printAdvice('administracion_medicamentos')">üñ®Ô∏è Imprimir Gu√≠a</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="advice-content" class="hidden">
                    <div class="card">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                            <h3 id="advice-title" class="result-title"></h3>
                            <button class="back-button" onclick="backToAdvice()">‚úï</button>
                        </div>
                        
                        <div class="advice-content" id="advice-text"></div>
                        
                        <div style="margin-top: 24px; padding-top: 16px; border-top: 1px solid #e5e7eb;">
                            <button class="button button-green" onclick="printCurrentAdvice()">
                                üñ®Ô∏è Imprimir esta Gu√≠a
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <p>‚ö†Ô∏è Esta herramienta es de apoyo cl√≠nico. Siempre verificar dosis y consultar con profesional sanitario.</p>
            <p>üè• <strong>VERIFICAR SIEMPRE la concentraci√≥n exacta en el envase del medicamento antes de administrar.</strong></p>
            <p>üìä Las escalas cl√≠nicas son herramientas de cribado - No sustituyen la evaluaci√≥n cl√≠nica completa.</p>
            <p>Basado en evidencia cient√≠fica actualizada 2024 ‚Ä¢ Desarrollado para profesionales de la salud</p>
        </div>
    </div>

    <script>
        // Global variables
        let currentScale = '';
        let scaleScores = {};
        let currentAdvice = '';

        // Medication database
        const medications = {
            // ANTIBI√ìTICOS
            amoxicilina: {
                name: 'Amoxicilina',
                category: 'Antibi√≥tico',
                dose: '40-90 mg/kg/d√≠a',
                frequency: 'cada 8-12 horas',
                maxDose: '3000 mg/d√≠a',
                presentation: 'Jarabe 250mg/5ml (50mg/ml) | Comp. 500mg, 875mg (‚â•15kg)',
                contraindications: 'Alergia a penicilinas',
                warnings: 'Vigilar reacciones al√©rgicas. VERIFICAR concentraci√≥n en envase.',
                calculate: (weight) => {
                    const dailyDose = weight * 50;
                    const perDose = dailyDose / 3;
                    const ml = (perDose / 250) * 5;
                    return { mg: perDose.toFixed(1), ml: ml.toFixed(1) };
                }
            },
            amoxicilina_clavulanico: {
                name: 'Amoxicilina-Clavul√°nico',
                category: 'Antibi√≥tico',
                dose: '40-80 mg/kg/d√≠a (amoxicilina)',
                frequency: 'cada 8-12 horas',
                maxDose: '2000 mg/d√≠a',
                presentation: 'Jarabe 400/57mg por 5ml | Comp. 500/125mg, 875/125mg',
                contraindications: 'Alergia a penicilinas, hepatotoxicidad previa',
                warnings: 'Administrar con alimentos. Riesgo de diarrea',
                calculate: (weight) => {
                    const dailyDose = weight * 50;
                    const perDose = dailyDose / 3;
                    const ml = (perDose / 400) * 5;
                    return { mg: perDose.toFixed(1), ml: ml.toFixed(1) };
                }
            },
            azitromicina: {
                name: 'Azitromicina',
                category: 'Antibi√≥tico',
                dose: '10 mg/kg/d√≠a',
                frequency: 'una vez al d√≠a por 3-5 d√≠as',
                maxDose: '500 mg/d√≠a',
                presentation: 'Jarabe 40mg/ml | Comp. 250mg, 500mg (‚â•15kg)',
                contraindications: 'Alergia a macr√≥lidos, arritmias card√≠acas',
                warnings: 'Administrar con est√≥mago vac√≠o. VERIFICAR concentraci√≥n en envase.',
                calculate: (weight) => {
                    const dailyDose = weight * 10;
                    const ml = dailyDose / 40;
                    return { mg: dailyDose.toFixed(1), ml: ml.toFixed(1) };
                }
            },
            claritromicina: {
                name: 'Claritromicina',
                category: 'Antibi√≥tico',
                dose: '15 mg/kg/d√≠a',
                frequency: 'cada 12 horas por 5-10 d√≠as',
                maxDose: '1000 mg/d√≠a',
                presentation: 'Jarabe 25mg/ml | Comp. 250mg, 500mg',
                contraindications: 'Alergia a macr√≥lidos',
                warnings: 'Administrar con alimentos. Interacciones m√∫ltiples',
                calculate: (weight) => {
                    const dailyDose = weight * 15;
                    const perDose = dailyDose / 2;
                    const ml = perDose / 25;
                    return { mg: perDose.toFixed(1), ml: ml.toFixed(1) };
                }
            },
            cefalexina: {
                name: 'Cefalexina',
                category: 'Antibi√≥tico',
                dose: '25-100 mg/kg/d√≠a',
                frequency: 'cada 6-8 horas',
                maxDose: '4000 mg/d√≠a',
                presentation: 'Jarabe 250mg/5ml (50mg/ml) | C√°ps. 500mg (‚â•15kg)',
                contraindications: 'Alergia a cefalosporinas',
                warnings: 'Precauci√≥n en alergia a penicilinas. VERIFICAR concentraci√≥n en envase.',
                calculate: (weight) => {
                    const dailyDose = weight * 50;
                    const perDose = dailyDose / 4;
                    const ml = (perDose / 250) * 5;
                    return { mg: perDose.toFixed(1), ml: ml.toFixed(1) };
                }
            },
            cefixima: {
                name: 'Cefixima',
                category: 'Antibi√≥tico',
                dose: '8 mg/kg/d√≠a',
                frequency: 'una vez al d√≠a o dividido cada 12h',
                maxDose: '400 mg/d√≠a',
                presentation: 'Jarabe 20mg/ml | Comp. 200mg, 400mg',
                contraindications: 'Alergia a cefalosporinas',
                warnings: 'Puede causar diarrea. Administrar con alimentos',
                calculate: (weight) => {
                    const dailyDose = weight * 8;
                    const ml = dailyDose / 20;
                    return { mg: dailyDose.toFixed(1), ml: ml.toFixed(1) };
                }
            },
            eritromicina: {
                name: 'Eritromicina',
                category: 'Antibi√≥tico',
                dose: '30-50 mg/kg/d√≠a',
                frequency: 'cada 6-8 horas',
                maxDose: '2000 mg/d√≠a',
                presentation: 'Jarabe 25mg/ml | Comp. 250mg, 500mg',
                contraindications: 'Alergia a macr√≥lidos',
                warnings: 'Administrar con est√≥mago vac√≠o. N√°useas frecuentes',
                calculate: (weight) => {
                    const dailyDose = weight * 40;
                    const perDose = dailyDose / 4;
                    const ml = perDose / 25;
                    return { mg: perDose.toFixed(1), ml: ml.toFixed(1) };
                }
            },
            ceftriaxona: {
                name: 'Ceftriaxona (hospitalaria)',
                category: 'Antibi√≥tico',
                dose: '50-100 mg/kg/d√≠a',
                frequency: 'cada 12-24 horas IM/IV',
                maxDose: '4000 mg/d√≠a',
                presentation: 'Vial 500mg, 1g, 2g',
                contraindications: 'Alergia a cefalosporinas, hiperbilirrubinemia neonatal',
                warnings: 'Solo uso hospitalario. No mezclar con calcio',
                calculate: (weight) => {
                    const dailyDose = weight * 75;
                    return { mg: dailyDose.toFixed(1), ml: 'Inyectable' };
                }
            },
            // ANALG√âSICOS/ANTIPIR√âTICOS
            paracetamol: {
                name: 'Paracetamol',
                category: 'Analg√©sico/Antipir√©tico',
                dose: '10-15 mg/kg/dosis',
                frequency: 'cada 4-6 horas (m√°x 5 dosis/d√≠a)',
                maxDose: '75 mg/kg/d√≠a',
                presentation: 'Jarabe 160mg/5ml (32mg/ml) | Gotas 100mg/ml',
                contraindications: 'Hepatopat√≠a grave',
                warnings: 'No exceder dosis m√°xima por riesgo hep√°tico',
                calculate: (weight) => {
                    const doseMg = weight * 15;
                    const jarabeMl = doseMg / 32;
                    return { mg: doseMg.toFixed(1), ml: jarabeMl.toFixed(1) };
                }
            },
            ibuprofeno: {
                name: 'Ibuprofeno',
                category: 'Analg√©sico/Antipir√©tico/Antiinflamatorio',
                dose: '5-10 mg/kg/dosis',
                frequency: 'cada 6-8 horas',
                maxDose: '40 mg/kg/d√≠a',
                presentation: 'Jarabe 100mg/5ml (20mg/ml) | Gotas 200mg/ml (CONCENTRADO)',
                contraindications: 'Alergia a AINEs, asma inducido por AINEs, <6 meses',
                warnings: 'No usar en varicela o deshidrataci√≥n',
                calculate: (weight) => {
                    const doseMg = weight * 7;
                    const jarabeMl = doseMg / 20;
                    return { mg: doseMg.toFixed(1), ml: jarabeMl.toFixed(1) };
                }
            },
            metamizol: {
                name: 'Metamizol (Nolotil)',
                category: 'Analg√©sico/Antipir√©tico',
                dose: '10-15 mg/kg/dosis',
                frequency: 'cada 6-8 horas',
                maxDose: '60 mg/kg/d√≠a',
                presentation: 'Gotas 500mg/ml | Amp. 575mg/ml',
                contraindications: 'Discrasias sangu√≠neas, porfiria',
                warnings: 'Risk de agranulocitosis. Uso restrictivo',
                calculate: (weight) => {
                    const doseMg = weight * 12;
                    const ml = doseMg / 500;
                    return { mg: doseMg.toFixed(1), ml: ml.toFixed(2) };
                }
            },
            // CORTICOIDES
            prednisolona: {
                name: 'Prednisolona',
                category: 'Corticoide',
                dose: '1-2 mg/kg/d√≠a',
                frequency: 'una vez al d√≠a o dividido en 2 dosis',
                maxDose: '60 mg/d√≠a',
                presentation: '15mg/5ml',
                contraindications: 'Infecciones sist√©micas no tratadas',
                warnings: 'Administrar con alimentos, no suspender bruscamente',
                calculate: (weight) => {
                    const dailyDose = weight * 1;
                    const ml = (dailyDose / 15) * 5;
                    return { mg: dailyDose.toFixed(1), ml: ml.toFixed(1) };
                }
            },
            dexametasona: {
                name: 'Dexametasona',
                category: 'Corticoide',
                dose: '0.15-0.6 mg/kg/d√≠a',
                frequency: 'una vez al d√≠a',
                maxDose: '16 mg/d√≠a',
                presentation: 'Jarabe 0.5mg/5ml | Amp. 4mg/ml',
                contraindications: 'Infecciones no tratadas',
                warnings: 'Potente corticoide. Usar m√≠nima dosis efectiva',
                calculate: (weight) => {
                    const dailyDose = weight * 0.3;
                    const ml = (dailyDose / 0.5) * 5;
                    return { mg: dailyDose.toFixed(2), ml: ml.toFixed(1) };
                }
            },
            hidrocortisona: {
                name: 'Hidrocortisona',
                category: 'Corticoide',
                dose: '2-8 mg/kg/d√≠a',
                frequency: 'cada 6-8 horas',
                maxDose: '300 mg/d√≠a',
                presentation: 'Vial 100mg, 500mg',
                contraindications: 'Infecciones no controladas',
                warnings: 'Para uso en crisis adrenal o shock',
                calculate: (weight) => {
                    const dailyDose = weight * 5;
                    const perDose = dailyDose / 4;
                    return { mg: perDose.toFixed(1), ml: 'Inyectable' };
                }
            },
            // BRONCODILATADORES
            salbutamol: {
                name: 'Salbutamol',
                category: 'Broncodilatador',
                dose: '0.1-0.15 mg/kg/dosis',
                frequency: 'cada 4-6 horas',
                maxDose: '5 mg/dosis',
                presentation: '2mg/5ml',
                contraindications: 'Hipersensibilidad',
                warnings: 'Puede causar taquicardia y temblor',
                calculate: (weight) => {
                    const perDose = weight * 0.15;
                    const ml = (perDose / 2) * 5;
                    return { mg: perDose.toFixed(1), ml: ml.toFixed(1) };
                }
            },
            terbutalina: {
                name: 'Terbutalina',
                category: 'Broncodilatador',
                dose: '0.05-0.1 mg/kg/dosis',
                frequency: 'cada 6-8 horas',
                maxDose: '7.5 mg/d√≠a',
                presentation: 'Jarabe 0.3mg/ml | Comp. 2.5mg',
                contraindications: 'Hipersensibilidad a simpaticomim√©ticos',
                warnings: 'Monitorizar frecuencia card√≠aca',
                calculate: (weight) => {
                    const perDose = weight * 0.075;
                    const ml = perDose / 0.3;
                    return { mg: perDose.toFixed(2), ml: ml.toFixed(1) };
                }
            },
            // ANTIHISTAM√çNICOS
            cetirizina: {
                name: 'Cetirizina',
                category: 'Antihistam√≠nico',
                dose: '0.25 mg/kg/d√≠a',
                frequency: 'una vez al d√≠a',
                maxDose: '10 mg/d√≠a',
                presentation: '1mg/ml',
                contraindications: 'Insuficiencia renal grave',
                warnings: 'Puede causar sedaci√≥n leve',
                calculate: (weight) => {
                    const dailyDose = weight * 0.25;
                    const ml = dailyDose;
                    return { mg: dailyDose.toFixed(1), ml: ml.toFixed(1) };
                }
            },
            loratadina: {
                name: 'Loratadina',
                category: 'Antihistam√≠nico',
                dose: '0.2 mg/kg/d√≠a',
                frequency: 'una vez al d√≠a',
                maxDose: '10 mg/d√≠a',
                presentation: 'Jarabe 1mg/ml | Comp. 10mg',
                contraindications: 'Hipersensibilidad',
                warnings: 'No sedante. Seguro para uso prolongado',
                calculate: (weight) => {
                    const dailyDose = weight * 0.2;
                    const ml = dailyDose;
                    return { mg: dailyDose.toFixed(1), ml: ml.toFixed(1) };
                }
            },
            hidroxicina: {
                name: 'Hidroxicina',
                category: 'Antihistam√≠nico sedante',
                dose: '2 mg/kg/d√≠a',
                frequency: 'cada 8-12 horas',
                maxDose: '100 mg/d√≠a',
                presentation: 'Jarabe 2mg/ml | Comp. 25mg',
                contraindications: 'Porfiria, retenci√≥n urinaria',
                warnings: 'Causa sedaci√≥n. No usar >7 d√≠as sin supervisi√≥n',
                calculate: (weight) => {
                    const dailyDose = weight * 2;
                    const perDose = dailyDose / 3;
                    const ml = perDose / 2;
                    return { mg: perDose.toFixed(1), ml: ml.toFixed(1) };
                }
            },
            // ANTIEM√âTICOS
            domperidona: {
                name: 'Domperidona',
                category: 'Antiem√©tico',
                dose: '0.25 mg/kg/dosis',
                frequency: 'cada 6-8 horas antes de comidas',
                maxDose: '30 mg/d√≠a',
                presentation: 'Jarabe 1mg/ml | Comp. 10mg',
                contraindications: 'Hemorragia GI, obstrucci√≥n intestinal',
                warnings: 'Administrar 15-30 min antes de comidas',
                calculate: (weight) => {
                    const perDose = weight * 0.25;
                    const ml = perDose;
                    return { mg: perDose.toFixed(1), ml: ml.toFixed(1) };
                }
            },
            ondansetron: {
                name: 'Ondansetr√≥n',
                category: 'Antiem√©tico',
                dose: '0.15 mg/kg/dosis',
                frequency: 'cada 8 horas',
                maxDose: '32 mg/d√≠a',
                presentation: 'Jarabe 0.8mg/ml | Amp. 2mg/ml',
                contraindications: 'Hipersensibilidad',
                warnings: 'Puede causar cefalea y estre√±imiento',
                calculate: (weight) => {
                    const perDose = weight * 0.15;
                    const ml = perDose / 0.8;
                    return { mg: perDose.toFixed(2), ml: ml.toFixed(1) };
                }
            },
            metoclopramida: {
                name: 'Metoclopramida',
                category: 'Antiem√©tico',
                dose: '0.1-0.2 mg/kg/dosis',
                frequency: 'cada 6-8 horas',
                maxDose: '30 mg/d√≠a',
                presentation: 'Jarabe 1mg/ml | Amp. 5mg/ml',
                contraindications: 'Obstrucci√≥n intestinal, epilepsia',
                warnings: 'Riesgo de diston√≠as. Uso limitado en pediatr√≠a',
                calculate: (weight) => {
                    const perDose = weight * 0.15;
                    const ml = perDose;
                    return { mg: perDose.toFixed(2), ml: ml.toFixed(1) };
                }
            },
            // MUCOL√çTICOS/EXPECTORANTES
            mucosolvan: {
                name: 'Ambroxol (Mucosolvan)',
                category: 'Mucol√≠tico',
                dose: '1.2-1.6 mg/kg/d√≠a',
                frequency: 'cada 8-12 horas',
                maxDose: '90 mg/d√≠a',
                presentation: 'Jarabe 3mg/ml | Comp. 30mg',
                contraindications: '√ölcera gastroduodenal activa',
                warnings: 'Aumentar ingesta de l√≠quidos',
                calculate: (weight) => {
                    const dailyDose = weight * 1.5;
                    const perDose = dailyDose / 2;
                    const ml = perDose / 3;
                    return { mg: perDose.toFixed(1), ml: ml.toFixed(1) };
                }
            },
            acetilcisteina: {
                name: 'Acetilciste√≠na',
                category: 'Mucol√≠tico',
                dose: '10-15 mg/kg/d√≠a',
                frequency: 'cada 8-12 horas',
                maxDose: '600 mg/d√≠a',
                presentation: 'Jarabe 20mg/ml | Sobres 100mg, 200mg',
                contraindications: '√ölcera p√©ptica activa',
                warnings: 'Olor caracter√≠stico. Diluir con zumo',
                calculate: (weight) => {
                    const dailyDose = weight * 12;
                    const perDose = dailyDose / 2;
                    const ml = perDose / 20;
                    return { mg: perDose.toFixed(1), ml: ml.toFixed(1) };
                }
            },
            // INHIBIDORES BOMBA PROTONES
            omeprazol: {
                name: 'Omeprazol',
                category: 'Inhibidor bomba protones',
                dose: '1 mg/kg/d√≠a',
                frequency: 'una vez al d√≠a en ayunas',
                maxDose: '40 mg/d√≠a',
                presentation: 'C√°ps. 10mg, 20mg | Sobres 10mg',
                contraindications: 'Hipersensibilidad',
                warnings: 'Administrar 30 min antes del desayuno',
                calculate: (weight) => {
                    const dailyDose = weight * 1;
                    return { mg: dailyDose.toFixed(1), ml: 'C√°psula' };
                }
            },
            lansoprazol: {
                name: 'Lansoprazol',
                category: 'Inhibidor bomba protones',
                dose: '1-1.5 mg/kg/d√≠a',
                frequency: 'una vez al d√≠a',
                maxDose: '30 mg/d√≠a',
                presentation: 'C√°ps. 15mg, 30mg',
                contraindications: 'Hipersensibilidad',
                warnings: 'Administrar antes del desayuno',
                calculate: (weight) => {
                    const dailyDose = weight * 1.2;
                    return { mg: dailyDose.toFixed(1), ml: 'C√°psula' };
                }
            },
            // LAXANTES
            lactulosa: {
                name: 'Lactulosa',
                category: 'Laxante osm√≥tico',
                dose: '1-3 ml/kg/d√≠a',
                frequency: 'una o dos veces al d√≠a',
                maxDose: '40 ml/d√≠a',
                presentation: 'Jarabe 667mg/ml',
                contraindications: 'Obstrucci√≥n intestinal, galactosemia',
                warnings: 'Puede causar flatulencia inicial',
                calculate: (weight) => {
                    const dailyDose = weight * 2;
                    return { mg: (dailyDose * 667).toFixed(0), ml: dailyDose.toFixed(1) };
                }
            },
            macrogol: {
                name: 'Macrogol (Movicol)',
                category: 'Laxante osm√≥tico',
                dose: '1-4 sobres/d√≠a seg√∫n edad',
                frequency: 'una o dos veces al d√≠a',
                maxDose: '4 sobres/d√≠a',
                presentation: 'Sobres 6.9g',
                contraindications: 'Obstrucci√≥n intestinal, perforaci√≥n',
                warnings: 'Disolver en agua. Aumentar ingesta l√≠quidos',
                calculate: (weight) => {
                    const sobres = weight < 12 ? 1 : weight < 25 ? 2 : 3;
                    return { mg: `${sobres} sobres`, ml: `${sobres * 125}ml agua` };
                }
            },
            // PROBI√ìTICOS
            lactobacillus: {
                name: 'Lactobacillus rhamnosus',
                category: 'Probi√≥tico',
                dose: '1-2 sobres/d√≠a',
                frequency: 'con las comidas',
                maxDose: '2 sobres/d√≠a',
                presentation: 'Sobres 6x10‚Åπ UFC',
                contraindications: 'Inmunodeficiencia severa',
                warnings: 'Conservar en fr√≠o. Separar de antibi√≥ticos',
                calculate: (weight) => {
                    const sobres = weight < 10 ? 1 : 2;
                    return { mg: `${sobres} sobres`, ml: 'Con comida' };
                }
            },
            // SOLUCIONES REHIDRATACI√ìN
            sro: {
                name: 'Suero Rehidrataci√≥n Oral',
                category: 'Rehidratante',
                dose: '75 ml/kg en 4 horas',
                frequency: 'peque√±as cantidades frecuentes',
                maxDose: 'Seg√∫n necesidades',
                presentation: 'Sobres con 245mOsm/L',
                contraindications: 'V√≥mitos incoercibles, shock',
                warnings: 'Preparar fresco. Usar en 24h',
                calculate: (weight) => {
                    const volumen4h = weight * 75;
                    const porHora = volumen4h / 4;
                    return { mg: `${volumen4h}ml en 4h`, ml: `${porHora.toFixed(0)}ml/h` };
                }
            },
            // T√ìPICOS
            fluticasona: {
                name: 'Fluticasona nasal',
                category: 'Corticoide t√≥pico',
                dose: '1-2 pulverizaciones/fosa nasal',
                frequency: 'una vez al d√≠a',
                maxDose: '200 mcg/d√≠a',
                presentation: 'Spray nasal 50mcg/dosis',
                contraindications: 'Infecci√≥n nasal no tratada',
                warnings: 'Uso prolongado: vigilar crecimiento',
                calculate: (weight) => {
                    return { mg: '50-100 mcg', ml: '1-2 pulv/fosa' };
                }
            },
            betametasona: {
                name: 'Betametasona t√≥pica',
                category: 'Corticoide t√≥pico',
                dose: 'Aplicaci√≥n t√≥pica 2-3 veces/d√≠a',
                frequency: 'cada 8-12 horas',
                maxDose: 'Seg√∫n extensi√≥n lesi√≥n',
                presentation: 'Crema 0.05%, Loci√≥n 0.05%',
                contraindications: 'Infecciones cut√°neas, rosacea',
                warnings: 'No usar en cara >7 d√≠as. Capa fina',
                calculate: (weight) => {
                    return { mg: 'T√≥pico', ml: 'Capa fina' };
                }
            },
            // ANTIT√âRMICOS RECTALES  
            paracetamol_supositorios: {
                name: 'Paracetamol supositorios',
                category: 'Antipir√©tico rectal',
                dose: '15-20 mg/kg/dosis',
                frequency: 'cada 6-8 horas',
                maxDose: '75 mg/kg/d√≠a',
                presentation: 'Sup. 125mg, 250mg, 500mg',
                contraindications: 'Fisuras anales, hepatopat√≠a',
                warnings: 'Refrigerar. Inserci√≥n suave',
                calculate: (weight) => {
                    const doseMg = weight * 17;
                    let supositorios = '';
                    if (doseMg <= 125) supositorios = '1 sup 125mg';
                    else if (doseMg <= 250) supositorios = '1 sup 250mg';
                    else if (doseMg <= 375) supositorios = '1.5 sup 250mg';
                    else supositorios = '1 sup 500mg';
                    return { mg: doseMg.toFixed(1), ml: supositorios };
                }
            }
        };

        // Clinical scales database
        const clinicalScales = {
            glasgow: {
                name: 'Escala de Glasgow Pedi√°trica',
                description: 'Evaluaci√≥n del nivel de conciencia en ni√±os',
                maxScore: 15,
                categories: {
                    apertura_ocular: {
                        name: 'Apertura Ocular',
                        items: [
                            { id: '4', text: 'Espont√°nea', points: 4 },
                            { id: '3', text: 'Al est√≠mulo verbal', points: 3 },
                            { id: '2', text: 'Al dolor', points: 2 },
                            { id: '1', text: 'No respuesta', points: 1 }
                        ]
                    },
                    respuesta_verbal: {
                        name: 'Respuesta Verbal',
                        items: [
                            { id: '5', text: '>2 a√±os: Orientado, charla social | <2 a√±os: Sonr√≠e, sigue objetos, interact√∫a', points: 5 },
                            { id: '4', text: '>2 a√±os: Confuso | <2 a√±os: Llanto consolable, interacci√≥n inapropiada', points: 4 },
                            { id: '3', text: '>2 a√±os: Palabras inapropiadas | <2 a√±os: Llanto inconsolable, irritable', points: 3 },
                            { id: '2', text: '>2 a√±os: Sonidos incomprensibles | <2 a√±os: Quejidos, agitaci√≥n', points: 2 },
                            { id: '1', text: 'Sin respuesta', points: 1 }
                        ]
                    },
                    respuesta_motora: {
                        name: 'Respuesta Motora',
                        items: [
                            { id: '6', text: '>1 a√±o: Obedece √≥rdenes | <1 a√±o: Movimientos normales espont√°neos', points: 6 },
                            { id: '5', text: 'Localiza el dolor', points: 5 },
                            { id: '4', text: 'Se retira al dolor', points: 4 },
                            { id: '3', text: 'Flexi√≥n anormal (decorticaci√≥n)', points: 3 },
                            { id: '2', text: 'Extensi√≥n anormal (descerebraci√≥n)', points: 2 },
                            { id: '1', text: 'Sin respuesta', points: 1 }
                        ]
                    }
                },
                interpretation: (score) => {
                    if (score >= 13) return { level: 'Normal', color: 'green', description: 'Nivel de conciencia normal' };
                    if (score >= 9) return { level: 'Leve', color: 'yellow', description: 'Traumatismo craneal leve' };
                    if (score >= 5) return { level: 'Moderado', color: 'orange', description: 'Traumatismo craneal moderado' };
                    return { level: 'Grave', color: 'red', description: 'Traumatismo craneal grave' };
                }
            },
            silverman: {
                name: 'Escala de Silverman-Andersen',
                description: 'Evaluaci√≥n de dificultad respiratoria neonatal',
                maxScore: 10,
                categories: {
                    movimiento_toracoabdominal: {
                        name: 'Movimiento T√≥raco-abdominal',
                        items: [
                            { id: '0', text: 'Sincronizado', points: 0 },
                            { id: '1', text: 'Retraso en la inspiraci√≥n', points: 1 },
                            { id: '2', text: 'Movimiento parad√≥jico (t√≥rax en balanc√≠n)', points: 2 }
                        ]
                    },
                    tiraje_intercostal: {
                        name: 'Tiraje Intercostal',
                        items: [
                            { id: '0', text: 'Ausente', points: 0 },
                            { id: '1', text: 'Discreto', points: 1 },
                            { id: '2', text: 'Intenso', points: 2 }
                        ]
                    },
                    retraccion_xifoidea: {
                        name: 'Retracci√≥n Xifoidea',
                        items: [
                            { id: '0', text: 'Ausente', points: 0 },
                            { id: '1', text: 'Moderada', points: 1 },
                            { id: '2', text: 'Intensa', points: 2 }
                        ]
                    },
                    aleteo_nasal: {
                        name: 'Aleteo Nasal',
                        items: [
                            { id: '0', text: 'Ausente', points: 0 },
                            { id: '1', text: 'M√≠nimo', points: 1 },
                            { id: '2', text: 'Intenso', points: 2 }
                        ]
                    },
                    quejido_espiratorio: {
                        name: 'Quejido Espiratorio',
                        items: [
                            { id: '0', text: 'Ausente', points: 0 },
                            { id: '1', text: 'Audible con estetoscopio', points: 1 },
                            { id: '2', text: 'Audible sin estetoscopio', points: 2 }
                        ]
                    }
                },
                interpretation: (score) => {
                    if (score === 0) return { level: 'Normal', color: 'green', description: 'Sin dificultad respiratoria' };
                    if (score <= 3) return { level: 'Leve', color: 'yellow', description: 'Dificultad respiratoria leve' };
                    if (score <= 6) return { level: 'Moderada', color: 'orange', description: 'Dificultad respiratoria moderada' };
                    return { level: 'Grave', color: 'red', description: 'Dificultad respiratoria grave - Requiere soporte respiratorio' };
                }
            },
            wood_downes: {
                name: 'Escala de Wood-Downes-Ferr√©s',
                description: 'Evaluaci√≥n de gravedad en bronquiolitis',
                maxScore: 15,
                categories: {
                    sibilancias: {
                        name: 'Sibilancias',
                        items: [
                            { id: '0', text: 'Ausentes', points: 0 },
                            { id: '1', text: 'Solo al final de la espiraci√≥n con estetoscopio', points: 1 },
                            { id: '2', text: 'Toda la espiraci√≥n con estetoscopio', points: 2 },
                            { id: '3', text: 'Inspiraci√≥n y espiraci√≥n sin estetoscopio', points: 3 }
                        ]
                    },
                    tirajes: {
                        name: 'Tirajes',
                        items: [
                            { id: '0', text: 'Ausentes', points: 0 },
                            { id: '1', text: 'Intercostales y subcostales', points: 1 },
                            { id: '2', text: 'Como en 1 + supraesternal', points: 2 },
                            { id: '3', text: 'Como en 2 + supraclavicular y aleteo nasal', points: 3 }
                        ]
                    },
                    frecuencia_respiratoria: {
                        name: 'Frecuencia Respiratoria',
                        items: [
                            { id: '0', text: '<30 rpm', points: 0 },
                            { id: '1', text: '31-45 rpm', points: 1 },
                            { id: '2', text: '46-60 rpm', points: 2 },
                            { id: '3', text: '>60 rpm', points: 3 }
                        ]
                    },
                    frecuencia_cardiaca: {
                        name: 'Frecuencia Card√≠aca',
                        items: [
                            { id: '0', text: '<120 lpm', points: 0 },
                            { id: '1', text: '120-140 lpm', points: 1 },
                            { id: '2', text: '141-160 lpm', points: 2 },
                            { id: '3', text: '>160 lpm', points: 3 }
                        ]
                    },
                    cianosis: {
                        name: 'Cianosis',
                        items: [
                            { id: '0', text: 'Ausente', points: 0 },
                            { id: '1', text: 'Perioral con llanto', points: 1 },
                            { id: '2', text: 'Perioral en reposo', points: 2 },
                            { id: '3', text: 'Generalizada en reposo', points: 3 }
                        ]
                    }
                },
                interpretation: (score) => {
                    if (score <= 3) return { level: 'Leve', color: 'green', description: 'Bronquiolitis leve - Tratamiento ambulatorio' };
                    if (score <= 8) return { level: 'Moderada', color: 'orange', description: 'Bronquiolitis moderada - Vigilancia hospitalaria' };
                    return { level: 'Grave', color: 'red', description: 'Bronquiolitis grave - Ingreso hospitalario urgente' };
                }
            },
            pews: {
                name: 'PEWS (Pediatric Early Warning Score)',
                description: 'Predicci√≥n de deterioro cl√≠nico en pacientes pedi√°tricos',
                maxScore: 9,
                categories: {
                    comportamiento: {
                        name: 'Comportamiento',
                        items: [
                            { id: '0', text: 'Jugando/Apropiado', points: 0 },
                            { id: '1', text: 'Durmiendo', points: 1 },
                            { id: '2', text: 'Irritable', points: 2 },
                            { id: '3', text: 'Let√°rgico/Confuso', points: 3 }
                        ]
                    },
                    cardiovascular: {
                        name: 'Sistema Cardiovascular',
                        items: [
                            { id: '0', text: 'Rosado O pulsos capilares <2 seg', points: 0 },
                            { id: '1', text: 'Palidez O pulsos capilares 3 seg', points: 1 },
                            { id: '2', text: 'Gris O pulsos capilares 4 seg O taquicardia 20 lpm sobre normal', points: 2 },
                            { id: '3', text: 'Gris Y moteado O pulsos capilares ‚â•5 seg O taquicardia 30 lpm sobre normal', points: 3 }
                        ]
                    },
                    respiratorio: {
                        name: 'Sistema Respiratorio',
                        items: [
                            { id: '0', text: 'En par√°metros normales', points: 0 },
                            { id: '1', text: '>10 rpm sobre normal O usa m√∫sculos accesorios O ox√≠geno al 30%', points: 1 },
                            { id: '2', text: '>20 rpm sobre normal O ox√≠geno al 40% O tiraje', points: 2 },
                            { id: '3', text: '>30 rpm sobre normal O ox√≠geno >50% O tiraje + quejido', points: 3 }
                        ]
                    }
                },
                interpretation: (score) => {
                    if (score <= 2) return { level: 'Bajo riesgo', color: 'green', description: 'Continuar observaci√≥n rutinaria' };
                    if (score <= 4) return { level: 'Riesgo moderado', color: 'yellow', description: 'Aumentar frecuencia de observaci√≥n' };
                    if (score <= 6) return { level: 'Alto riesgo', color: 'orange', description: 'Contactar m√©dico urgente' };
                    return { level: 'Cr√≠tico', color: 'red', description: 'Activar equipo de emergencia pedi√°trica' };
                }
            },
            westley: {
                name: 'Escala de Westley (Crup)',
                description: 'Evaluaci√≥n de gravedad del crup/laringitis',
                maxScore: 17,
                categories: {
                    nivel_conciencia: {
                        name: 'Nivel de Conciencia',
                        items: [
                            { id: '0', text: 'Normal', points: 0 },
                            { id: '5', text: 'Alterado', points: 5 }
                        ]
                    },
                    cianosis: {
                        name: 'Cianosis',
                        items: [
                            { id: '0', text: 'Ausente', points: 0 },
                            { id: '4', text: 'Con agitaci√≥n', points: 4 },
                            { id: '5', text: 'En reposo', points: 5 }
                        ]
                    },
                    estridor: {
                        name: 'Estridor',
                        items: [
                            { id: '0', text: 'Ausente', points: 0 },
                            { id: '1', text: 'Con agitaci√≥n', points: 1 },
                            { id: '2', text: 'En reposo', points: 2 }
                        ]
                    },
                    entrada_aire: {
                        name: 'Entrada de Aire',
                        items: [
                            { id: '0', text: 'Normal', points: 0 },
                            { id: '1', text: 'Levemente disminuida', points: 1 },
                            { id: '2', text: 'Moderadamente disminuida', points: 2 }
                        ]
                    },
                    tiraje: {
                        name: 'Tiraje',
                        items: [
                            { id: '0', text: 'Ausente', points: 0 },
                            { id: '1', text: 'Leve', points: 1 },
                            { id: '2', text: 'Moderado', points: 2 },
                            { id: '3', text: 'Severo', points: 3 }
                        ]
                    }
                },
                interpretation: (score) => {
                    if (score <= 2) return { level: 'Leve', color: 'green', description: 'Crup leve - Tratamiento ambulatorio' };
                    if (score <= 7) return { level: 'Moderado', color: 'orange', description: 'Crup moderado - Valorar ingreso' };
                    return { level: 'Severo', color: 'red', description: 'Crup severo - Ingreso hospitalario urgente' };
                }
            },
            fiebre: {
                name: 'Escala de Evaluaci√≥n de Fiebre Pedi√°trica',
                description: 'Evaluaci√≥n de riesgo en ni√±os con fiebre',
                maxScore: 12,
                categories: {
                    edad: {
                        name: 'Edad del Paciente',
                        items: [
                            { id: '0', text: '>6 meses', points: 0 },
                            { id: '2', text: '3-6 meses', points: 2 },
                            { id: '4', text: '<3 meses', points: 4 }
                        ]
                    },
                    temperatura: {
                        name: 'Temperatura M√°xima',
                        items: [
                            { id: '0', text: '38-38.9¬∞C', points: 0 },
                            { id: '1', text: '39-39.9¬∞C', points: 1 },
                            { id: '2', text: '‚â•40¬∞C', points: 2 }
                        ]
                    },
                    estado_general: {
                        name: 'Estado General',
                        items: [
                            { id: '0', text: 'Activo, reactivo, juega', points: 0 },
                            { id: '1', text: 'Irritable pero consolable', points: 1 },
                            { id: '2', text: 'Let√°rgico, poco reactivo', points: 2 },
                            { id: '3', text: 'Muy alterado, inconsolable', points: 3 }
                        ]
                    },
                    signos_focales: {
                        name: 'Signos de Alarma',
                        items: [
                            { id: '0', text: 'Ninguno', points: 0 },
                            { id: '1', text: 'Dificultad respiratoria leve', points: 1 },
                            { id: '2', text: 'Petequias/exantema', points: 2 },
                            { id: '3', text: 'Rigidez de nuca/convulsiones', points: 3 }
                        ]
                    }
                },
                interpretation: (score) => {
                    if (score <= 2) return { level: 'Bajo riesgo', color: 'green', description: 'Tratamiento ambulatorio - Control en 24-48h' };
                    if (score <= 5) return { level: 'Riesgo moderado', color: 'yellow', description: 'Valorar anal√≠tica - Control estrecho' };
                    if (score <= 8) return { level: 'Alto riesgo', color: 'orange', description: 'Probable ingreso - Anal√≠tica urgente' };
                    return { level: 'Muy alto riesgo', color: 'red', description: 'Ingreso inmediato - Antibi√≥tico emp√≠rico' };
                }
            },
            young_infant: {
                name: 'Young Infant Observation Scale (YIOS)',
                description: 'Evaluaci√≥n de lactantes febriles 1-3 meses',
                maxScore: 18,
                categories: {
                    calidad_llanto: {
                        name: 'Calidad del Llanto',
                        items: [
                            { id: '1', text: 'Fuerte, normal', points: 1 },
                            { id: '2', text: 'Gemidos o sollozos', points: 2 },
                            { id: '3', text: 'D√©bil, agudo o silencioso', points: 3 }
                        ]
                    },
                    reaccion_estimulos: {
                        name: 'Reacci√≥n a Est√≠mulos',
                        items: [
                            { id: '1', text: 'Llora inmediatamente', points: 1 },
                            { id: '2', text: 'Llora despu√©s de estimulaci√≥n prolongada', points: 2 },
                            { id: '3', text: 'Llora d√©bilmente o no llora', points: 3 }
                        ]
                    },
                    estado_despierto: {
                        name: 'Estado Despierto',
                        items: [
                            { id: '1', text: 'Despierto, se mantiene despierto', points: 1 },
                            { id: '2', text: 'Ojos abiertos brevemente', points: 2 },
                            { id: '3', text: 'No se despierta o permanece dormido', points: 3 }
                        ]
                    },
                    sonrisa_social: {
                        name: 'Sonrisa Social',
                        items: [
                            { id: '1', text: 'Sonr√≠e', points: 1 },
                            { id: '2', text: 'Sonrisa breve', points: 2 },
                            { id: '3', text: 'No sonr√≠e', points: 3 }
                        ]
                    },
                    alerta: {
                        name: 'Estado de Alerta',
                        items: [
                            { id: '1', text: 'Alerta', points: 1 },
                            { id: '2', text: 'Alerta brevemente', points: 2 },
                            { id: '3', text: 'No est√° alerta', points: 3 }
                        ]
                    },
                    coloracion: {
                        name: 'Coloraci√≥n',
                        items: [
                            { id: '1', text: 'Rosado', points: 1 },
                            { id: '2', text: 'Extremidades azules/p√°lidas', points: 2 },
                            { id: '3', text: 'P√°lido, cian√≥tico, moteado', points: 3 }
                        ]
                    }
                },
                interpretation: (score) => {
                    if (score <= 10) return { level: 'Bajo riesgo', color: 'green', description: 'Enfermedad bacteriana grave poco probable' };
                    if (score <= 16) return { level: 'Riesgo intermedio', color: 'yellow', description: 'Valorar estudios complementarios' };
                    return { level: 'Alto riesgo', color: 'red', description: 'Alta probabilidad enfermedad bacteriana grave' };
                }
            },
            yale_observation: {
                name: 'Yale Observation Scale (YOS)',
                description: 'Evaluaci√≥n de ni√±os febriles 3-36 meses',
                maxScore: 18,
                categories: {
                    calidad_llanto: {
                        name: 'Calidad del Llanto',
                        items: [
                            { id: '1', text: 'Fuerte con tono normal O contento y no llora', points: 1 },
                            { id: '2', text: 'Gemidos o sollozos', points: 2 },
                            { id: '3', text: 'D√©bil, agudo, continuo O apenas responde', points: 3 }
                        ]
                    },
                    reaccion_padres: {
                        name: 'Reacci√≥n a Estimulaci√≥n Parental',
                        items: [
                            { id: '1', text: 'Llora brevemente, luego para O contento y no llora', points: 1 },
                            { id: '2', text: 'Llora intermitentemente', points: 2 },
                            { id: '3', text: 'Llanto continuo O apenas responde', points: 3 }
                        ]
                    },
                    estado_despierto: {
                        name: 'Estado Despierto',
                        items: [
                            { id: '1', text: 'Permanece despierto O se despierta r√°pidamente', points: 1 },
                            { id: '2', text: 'Ojos abiertos brevemente O se despierta con estimulaci√≥n prolongada', points: 2 },
                            { id: '3', text: 'Se queda dormido O no se despierta', points: 3 }
                        ]
                    },
                    sonrisa_social: {
                        name: 'Sonrisa Social',
                        items: [
                            { id: '1', text: 'Sonr√≠e', points: 1 },
                            { id: '2', text: 'Sonrisa breve', points: 2 },
                            { id: '3', text: 'No sonr√≠e', points: 3 }
                        ]
                    },
                    tacto_vocaliza: {
                        name: 'Tacto/Vocalizaci√≥n',
                        items: [
                            { id: '1', text: 'Juega, vocaliza O contento', points: 1 },
                            { id: '2', text: 'Vocaliza brevemente', points: 2 },
                            { id: '3', text: 'No vocaliza O gru√±e', points: 3 }
                        ]
                    },
                    coloracion: {
                        name: 'Coloraci√≥n',
                        items: [
                            { id: '1', text: 'Rosado', points: 1 },
                            { id: '2', text: 'Extremidades azules/p√°lidas', points: 2 },
                            { id: '3', text: 'P√°lido, cian√≥tico, moteado o gris', points: 3 }
                        ]
                    }
                },
                interpretation: (score) => {
                    if (score <= 10) return { level: 'Bajo riesgo', color: 'green', description: 'Infecci√≥n bacteriana grave poco probable (<3%)' };
                    if (score <= 16) return { level: 'Riesgo moderado', color: 'yellow', description: 'Riesgo intermedio (3-26%)' };
                    return { level: 'Alto riesgo', color: 'red', description: 'Alto riesgo de infecci√≥n bacteriana grave (>92%)' };
                }
            },
            sepsis_pediatrica: {
                name: 'Escala de Sepsis Pedi√°trica',
                description: 'Criterios de sepsis/shock s√©ptico pedi√°trico',
                maxScore: 15,
                categories: {
                    temperatura: {
                        name: 'Temperatura',
                        items: [
                            { id: '0', text: '36-38.5¬∞C', points: 0 },
                            { id: '2', text: '>38.5¬∞C o <36¬∞C', points: 2 },
                            { id: '3', text: '>40¬∞C o <35¬∞C', points: 3 }
                        ]
                    },
                    frecuencia_cardiaca: {
                        name: 'Frecuencia Card√≠aca',
                        items: [
                            { id: '0', text: 'Normal para la edad', points: 0 },
                            { id: '2', text: 'Taquicardia >2 DS para edad', points: 2 },
                            { id: '3', text: 'Bradicardia <10¬∞ percentil para edad', points: 3 }
                        ]
                    },
                    frecuencia_respiratoria: {
                        name: 'Frecuencia Respiratoria',
                        items: [
                            { id: '0', text: 'Normal para la edad', points: 0 },
                            { id: '2', text: 'Taquipnea >2 DS para edad', points: 2 },
                            { id: '3', text: 'Ventilaci√≥n mec√°nica por proceso agudo', points: 3 }
                        ]
                    },
                    estado_mental: {
                        name: 'Estado Mental',
                        items: [
                            { id: '0', text: 'Normal', points: 0 },
                            { id: '2', text: 'Irritabilidad, letargo', points: 2 },
                            { id: '4', text: 'Estupor, coma, delirium', points: 4 }
                        ]
                    },
                    perfusion: {
                        name: 'Perfusi√≥n',
                        items: [
                            { id: '0', text: 'Normal', points: 0 },
                            { id: '1', text: 'Relleno capilar 2-4 seg', points: 1 },
                            { id: '2', text: 'Relleno capilar >4 seg', points: 2 },
                            { id: '3', text: 'Hipotensi√≥n, oliguria, acidosis', points: 3 }
                        ]
                    }
                },
                interpretation: (score) => {
                    if (score <= 3) return { level: 'Bajo riesgo', color: 'green', description: 'Sepsis poco probable' };
                    if (score <= 7) return { level: 'Riesgo moderado', color: 'yellow', description: 'Posible sepsis - Valorar antibioterapia' };
                    if (score <= 11) return { level: 'Alto riesgo', color: 'orange', description: 'Sepsis probable - Antibi√≥ticos + ingreso' };
                    return { level: 'Muy alto riesgo', color: 'red', description: 'Shock s√©ptico - Manejo agresivo UCI' };
                }
            }
        };

        // Parental advice
        const parentalAdvice = {
            gastroenteritis: {
                title: "Gastroenteritis - Gu√≠a R√°pida para Padres",
                content: `ü§¢ GASTROENTERITIS EN NI√ëOS - GU√çA R√ÅPIDA

‚ö†Ô∏è CU√ÅNDO IR AL M√âDICO INMEDIATAMENTE:
‚Ä¢ Sangre en v√≥mitos o caca
‚Ä¢ No hace pis en 8 horas
‚Ä¢ Muy dormido o confuso
‚Ä¢ Fiebre muy alta (>39¬∞C)
‚Ä¢ Dolor de barriga muy fuerte

‚úÖ QU√â HACER EN CASA:
1. DAR L√çQUIDOS POCO A POCO
   ‚Ä¢ Suero de farmacia (mejor opci√≥n)
   ‚Ä¢ Agua, caldos suaves
   ‚Ä¢ Una cucharita cada 5 minutos

2. COMIDA
   ‚Ä¢ No quitar comida si tiene hambre
   ‚Ä¢ Arroz, pl√°tano, pollo hervido
   ‚Ä¢ Evitar l√°cteos si empeora

3. MEDICINAS
   ‚Ä¢ NO dar medicinas para cortar diarrea
   ‚Ä¢ Paracetamol solo si fiebre
   ‚Ä¢ NO antibi√≥ticos (no sirven)

üè† CUIDADOS:
‚Ä¢ Lavarse las manos mucho
‚Ä¢ Limpiar con lej√≠a
‚Ä¢ Descanso

üìû LLAMAR AL M√âDICO SI:
‚Ä¢ Diarrea m√°s de 3 d√≠as
‚Ä¢ V√≥mitos que no paran
‚Ä¢ Se ve muy enfermo

¬°IMPORTANTE! Los ni√±os se curan solos en 2-3 d√≠as con l√≠quidos`
            },
            fiebre: {
                title: "Fiebre - Gu√≠a R√°pida para Padres",
                content: `üå°Ô∏è FIEBRE EN NI√ëOS - GU√çA R√ÅPIDA

‚ö†Ô∏è IR AL M√âDICO YA SI:
‚Ä¢ Beb√© menor de 3 meses con fiebre
‚Ä¢ Dificultad para respirar
‚Ä¢ Manchitas rojas en la piel
‚Ä¢ Muy dormido o raro
‚Ä¢ Convulsiones
‚Ä¢ Rigidez en el cuello

‚úÖ C√ìMO TRATAR LA FIEBRE:
1. MEDICINAS (solo si est√° molesto)
   ‚Ä¢ Paracetamol: cada 6 horas
   ‚Ä¢ Ibuprofeno: cada 8 horas (>6 meses)
   ‚Ä¢ NO mezclar los dos

2. CUIDADOS
   ‚Ä¢ Ropa ligera
   ‚Ä¢ Mucha agua
   ‚Ä¢ Ambiente fresco
   ‚Ä¢ Ba√±o tibio si quiere

‚ùå NO HACER:
‚Ä¢ Alcohol en la piel
‚Ä¢ Pa√±os fr√≠os
‚Ä¢ Desnudar completamente
‚Ä¢ Alternar medicinas

üè† LA FIEBRE:
‚Ä¢ Es defensa del cuerpo
‚Ä¢ No causa da√±o al cerebro
‚Ä¢ Lo importante es c√≥mo se ve el ni√±o

üìû LLAMAR AL M√âDICO SI:
‚Ä¢ Fiebre m√°s de 3 d√≠as
‚Ä¢ No mejora con medicina
‚Ä¢ Est√° muy deca√≠do
‚Ä¢ No bebe l√≠quidos

¬°RECUERDA! Si juega y sonr√≠e, no pasa nada grave`
            },
            administracion_medicamentos: {
                title: "Dar Medicinas - Gu√≠a R√°pida para Padres",
                content: `üíä C√ìMO DAR MEDICINAS A NI√ëOS - GU√çA R√ÅPIDA

‚ö†Ô∏è ANTES DE DAR CUALQUIER MEDICINA:
‚Ä¢ Leer el envase SIEMPRE
‚Ä¢ Comprobar la fecha
‚Ä¢ Ver si es el ni√±o correcto
‚Ä¢ Usar la jeringa del envase

‚úÖ REGLAS DE ORO:
1. DOSIS POR PESO (no por edad)
2. USAR JERINGA (no cucharas)
3. LEER CONCENTRACI√ìN
4. ANOTAR QU√â DAS Y CU√ÅNDO

ü•Ñ C√ìMO D√ÅRSELA:
‚Ä¢ Ni√±o sentado
‚Ä¢ Poco a poco
‚Ä¢ En el lado de la boca (beb√©s)
‚Ä¢ Mezclar con comida favorita si es dif√≠cil

ü§Æ SI VOMITA:
‚Ä¢ Antes de 15 min ‚Üí Repetir dosis completa
‚Ä¢ Entre 15-30 min ‚Üí Media dosis
‚Ä¢ Despu√©s de 30 min ‚Üí Esperar siguiente toma

üì¶ GUARDAR MEDICINAS:
‚Ä¢ Fuera del alcance de ni√±os
‚Ä¢ En sitio fresco y seco
‚Ä¢ Antibi√≥ticos l√≠quidos en nevera
‚Ä¢ Tirar lo que sobre

‚ùå ERRORES QUE NO HACER:
‚Ä¢ Doblar dosis si se olvida
‚Ä¢ Usar cucharas de cocina
‚Ä¢ Partir pastillas de adultos
‚Ä¢ Guardar sobras para otra vez
‚Ä¢ Parar antibi√≥ticos antes de tiempo

üö® EMERGENCIA (DEMASIADA MEDICINA):
‚Ä¢ Llamar: 915 620 420 (Toxicolog√≠a)
‚Ä¢ Llevar envase al hospital
‚Ä¢ NO provocar v√≥mito

¬°IMPORTANTE! En caso de duda, siempre preguntar al m√©dico o farmac√©utico`
            }
        };

        // Tab navigation
        function showTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.nav-button').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        // Function to generate alternative pharmaceutical forms based on weight
        function generateAlternativeForms(medicationKey, weight, doseMg) {
            let alternatives = '';
            
            if (medicationKey === 'paracetamol') {
                // Todas las presentaciones l√≠quidas
                alternatives += `
                    <div style="background: #f0f9ff; border: 1px solid #93c5fd; padding: 8px; border-radius: 4px; margin-bottom: 6px;">
                        <p style="font-size: 12px; color: #1e40af; margin: 0;"><strong>Jarabe 120mg/5ml (24mg/ml):</strong> ${(doseMg / 24).toFixed(1)} ml</p>
                    </div>
                `;
                if (weight >= 10) {
                    // Supositorios
                    const sup125 = Math.round(doseMg / 125);
                    const sup250 = Math.round(doseMg / 250 * 2) / 2;
                    alternatives += `
                        <div style="background: #f0f9ff; border: 1px solid #93c5fd; padding: 8px; border-radius: 4px; margin-bottom: 6px;">
                            <p style="font-size: 12px; color: #1e40af; margin: 0;"><strong>Supositorios 125mg:</strong> ${sup125} sup.</p>
                        </div>
                    `;
                    if (weight >= 15) {
                        alternatives += `
                            <div style="background: #f0f9ff; border: 1px solid #93c5fd; padding: 8px; border-radius: 4px; margin-bottom: 6px;">
                                <p style="font-size: 12px; color: #1e40af; margin: 0;"><strong>Supositorios 250mg:</strong> ${sup250} sup.</p>
                            </div>
                        `;
                    }
                }
                if (weight >= 15) {
                    // Comprimidos bucodispersables 250mg
                    const comp250 = Math.round(doseMg / 250 * 2) / 2;
                    alternatives += `
                        <div style="background: #f0f9ff; border: 1px solid #93c5fd; padding: 8px; border-radius: 4px; margin-bottom: 6px;">
                            <p style="font-size: 12px; color: #1e40af; margin: 0;"><strong>Comp. bucodispersables 250mg:</strong> ${comp250} comp.</p>
                        </div>
                    `;
                }
                if (weight >= 20) {
                    // Comprimidos 500mg
                    const comp500 = Math.round(doseMg / 500 * 2) / 2;
                    const sup500 = Math.round(doseMg / 500 * 2) / 2;
                    alternatives += `
                        <div style="background: #f0f9ff; border: 1px solid #93c5fd; padding: 8px; border-radius: 4px; margin-bottom: 6px;">
                            <p style="font-size: 12px; color: #1e40af; margin: 0;"><strong>Comprimidos 500mg:</strong> ${comp500} comp.</p>
                        </div>
                        <div style="background: #f0f9ff; border: 1px solid #93c5fd; padding: 8px; border-radius: 4px; margin-bottom: 6px;">
                            <p style="font-size: 12px; color: #1e40af; margin: 0;"><strong>Supositorios 500mg:</strong> ${sup500} sup.</p>
                        </div>
                    `;
                }
                if (weight >= 25) {
                    // Sobres efervescentes 650mg y 1g
                    const sobres650 = Math.round(doseMg / 650 * 2) / 2;
                    const sobres1000 = Math.round(doseMg / 1000 * 2) / 2;
                    alternatives += `
                        <div style="background: #f0f9ff; border: 1px solid #93c5fd; padding: 8px; border-radius: 4px; margin-bottom: 6px;">
                            <p style="font-size: 12px; color: #1e40af; margin: 0;"><strong>Sobres efervescentes 650mg:</strong> ${sobres650} sobres</p>
                        </div>
                        <div style="background: #f0f9ff; border: 1px solid #93c5fd; padding: 8px; border-radius: 4px; margin-bottom: 6px;">
                            <p style="font-size: 12px; color: #1e40af; margin: 0;"><strong>Sobres efervescentes 1g:</strong> ${sobres1000} sobres</p>
                        </div>
                    `;
                }
            }
            
            if (medicationKey === 'ibuprofeno') {
                // Jarabe alternativo
                alternatives += `
                    <div style="background: #eff6ff; border: 1px solid #93c5fd; padding: 8px; border-radius: 4px; margin-bottom: 6px;">
                        <p style="font-size: 12px; color: #1d4ed8; margin: 0;"><strong>Jarabe 40mg/ml:</strong> ${(doseMg / 40).toFixed(1)} ml</p>
                    </div>
                `;
                if (weight >= 8) {
                    // Supositorios pedi√°tricos
                    const sup60 = Math.round(doseMg / 60);
                    const sup125 = Math.round(doseMg / 125);
                    alternatives += `
                        <div style="background: #eff6ff; border: 1px solid #93c5fd; padding: 8px; border-radius: 4px; margin-bottom: 6px;">
                            <p style="font-size: 12px; color: #1d4ed8; margin: 0;"><strong>Supositorios 60mg:</strong> ${sup60} sup.</p>
                        </div>
                        <div style="background: #eff6ff; border: 1px solid #93c5fd; padding: 8px; border-radius: 4px; margin-bottom: 6px;">
                            <p style="font-size: 12px; color: #1d4ed8; margin: 0;"><strong>Supositorios 125mg:</strong> ${sup125} sup.</p>
                        </div>
                    `;
                }
                if (weight >= 15) {
                    // Comprimidos bucodispersables 200mg
                    const comp200 = Math.round(doseMg / 200 * 2) / 2;
                    alternatives += `
                        <div style="background: #eff6ff; border: 1px solid #93c5fd; padding: 8px; border-radius: 4px; margin-bottom: 6px;">
                            <p style="font-size: 12px; color: #1d4ed8; margin: 0;"><strong>Comp. bucodispersables 200mg:</strong> ${comp200} comp.</p>
                        </div>
                    `;
                }
                if (weight >= 20) {
                    // Comprimidos 400mg
                    const comp400 = Math.round(doseMg / 400 * 2) / 2;
                    alternatives += `
                        <div style="background: #eff6ff; border: 1px solid #93c5fd; padding: 8px; border-radius: 4px; margin-bottom: 6px;">
                            <p style="font-size: 12px; color: #1d4ed8; margin: 0;"><strong>Comprimidos 400mg:</strong> ${comp400} comp.</p>
                        </div>
                    `;
                }
                if (weight >= 30) {
                    // Comprimidos 600mg
                    const comp600 = Math.round(doseMg / 600 * 2) / 2;
                    alternatives += `
                        <div style="background: #eff6ff; border: 1px solid #93c5fd; padding: 8px; border-radius: 4px; margin-bottom: 6px;">
                            <p style="font-size: 12px; color: #1d4ed8; margin: 0;"><strong>Comprimidos 600mg:</strong> ${comp600} comp.</p>
                        </div>
                    `;
                }
            }
            
            // ANTIBI√ìTICOS - Presentaciones alternativas
            if (medicationKey === 'amoxicilina') {
                // Jarabe alternativo
                alternatives += `
                    <div style="background: #f0fdf4; border: 1px solid #86efac; padding: 8px; border-radius: 4px; margin-bottom: 6px;">
                        <p style="font-size: 12px; color: #166534; margin: 0;"><strong>Jarabe 125mg/5ml (25mg/ml):</strong> ${(doseMg / 25).toFixed(1)} ml</p>
                    </div>
                `;
                if (weight >= 10) {
                    // C√°psulas para ni√±os mayores
                    const caps250 = Math.round(doseMg / 250);
                    alternatives += `
                        <div style="background: #f0fdf4; border: 1px solid #86efac; padding: 8px; border-radius: 4px; margin-bottom: 6px;">
                            <p style="font-size: 12px; color: #166534; margin: 0;"><strong>C√°psulas 250mg:</strong> ${caps250} c√°ps.</p>
                        </div>
                    `;
                }
                if (weight >= 15) {
                    const comp500 = Math.round(doseMg / 500 * 2) / 2;
                    const caps500 = Math.round(doseMg / 500 * 2) / 2;
                    alternatives += `
                        <div style="background: #f0fdf4; border: 1px solid #86efac; padding: 8px; border-radius: 4px; margin-bottom: 6px;">
                            <p style="font-size: 12px; color: #166534; margin: 0;"><strong>Comprimidos 500mg:</strong> ${comp500} comp.</p>
                        </div>
                        <div style="background: #f0fdf4; border: 1px solid #86efac; padding: 8px; border-radius: 4px; margin-bottom: 6px;">
                            <p style="font-size: 12px; color: #166534; margin: 0;"><strong>C√°psulas 500mg:</strong> ${caps500} c√°ps.</p>
                        </div>
                    `;
                }
                if (weight >= 25) {
                    const comp875 = Math.round(doseMg / 875 * 2) / 2;
                    alternatives += `
                        <div style="background: #f0fdf4; border: 1px solid #86efac; padding: 8px; border-radius: 4px; margin-bottom: 6px;">
                            <p style="font-size: 12px; color: #166534; margin: 0;"><strong>Comprimidos 875mg:</strong> ${comp875} comp.</p>
                        </div>
                    `;
                }
            }
            
            if (medicationKey === 'azitromicina') {
                // Jarabe diluci√≥n alternativa
                alternatives += `
                    <div style="background: #f0fdf4; border: 1px solid #86efac; padding: 8px; border-radius: 4px; margin-bottom: 6px;">
                        <p style="font-size: 12px; color: #166534; margin: 0;"><strong>Jarabe 100mg/5ml (20mg/ml):</strong> ${(doseMg / 20).toFixed(1)} ml</p>
                    </div>
                    <div style="background: #f0fdf4; border: 1px solid #86efac; padding: 8px; border-radius: 4px; margin-bottom: 6px;">
                        <p style="font-size: 12px; color: #166534; margin: 0;"><strong>Jarabe 200mg/5ml (40mg/ml):</strong> ${(doseMg / 40).toFixed(1)} ml</p>
                    </div>
                `;
                if (weight >= 10) {
                    const caps250 = Math.round(doseMg / 250);
                    alternatives += `
                        <div style="background: #f0fdf4; border: 1px solid #86efac; padding: 8px; border-radius: 4px; margin-bottom: 6px;">
                            <p style="font-size: 12px; color: #166534; margin: 0;"><strong>C√°psulas 250mg:</strong> ${caps250} c√°ps.</p>
                        </div>
                    `;
                }
                if (weight >= 15) {
                    const comp250 = Math.round(doseMg / 250 * 2) / 2;
                    alternatives += `
                        <div style="background: #f0fdf4; border: 1px solid #86efac; padding: 8px; border-radius: 4px; margin-bottom: 6px;">
                            <p style="font-size: 12px; color: #166534; margin: 0;"><strong>Comprimidos 250mg:</strong> ${comp250} comp.</p>
                        </div>
                    `;
                }
                if (weight >= 25) {
                    const comp500 = Math.round(doseMg / 500 * 2) / 2;
                    alternatives += `
                        <div style="background: #f0fdf4; border: 1px solid #86efac; padding: 8px; border-radius: 4px; margin-bottom: 6px;">
                            <p style="font-size: 12px; color: #166534; margin: 0;"><strong>Comprimidos 500mg:</strong> ${comp500} comp.</p>
                        </div>
                    `;
                }
            }
            
            if (medicationKey === 'cefalexina') {
                // Jarabe alternativo
                alternatives += `
                    <div style="background: #f0fdf4; border: 1px solid #86efac; padding: 8px; border-radius: 4px; margin-bottom: 6px;">
                        <p style="font-size: 12px; color: #166534; margin: 0;"><strong>Jarabe 125mg/5ml (25mg/ml):</strong> ${(doseMg / 25).toFixed(1)} ml</p>
                    </div>
                `;
                if (weight >= 10) {
                    const caps250 = Math.round(doseMg / 250);
                    alternatives += `
                        <div style="background: #f0fdf4; border: 1px solid #86efac; padding: 8px; border-radius: 4px; margin-bottom: 6px;">
                            <p style="font-size: 12px; color: #166534; margin: 0;"><strong>C√°psulas 250mg:</strong> ${caps250} c√°ps.</p>
                        </div>
                    `;
                }
                if (weight >= 15) {
                    const caps500 = Math.round(doseMg / 500 * 2) / 2;
                    const comp500 = Math.round(doseMg / 500 * 2) / 2;
                    alternatives += `
                        <div style="background: #f0fdf4; border: 1px solid #86efac; padding: 8px; border-radius: 4px; margin-bottom: 6px;">
                            <p style="font-size: 12px; color: #166534; margin: 0;"><strong>C√°psulas 500mg:</strong> ${caps500} c√°ps.</p>
                        </div>
                        <div style="background: #f0fdf4; border: 1px solid #86efac; padding: 8px; border-radius: 4px; margin-bottom: 6px;">
                            <p style="font-size: 12px; color: #166534; margin: 0;"><strong>Comprimidos 500mg:</strong> ${comp500} comp.</p>
                        </div>
                    `;
                }
            }

            if (medicationKey === 'cetirizina') {
                // Jarabe alternativo
                alternatives += `
                    <div style="background: #fef3c7; border: 1px solid #fcd34d; padding: 8px; border-radius: 4px; margin-bottom: 6px;">
                        <p style="font-size: 12px; color: #92400e; margin: 0;"><strong>Jarabe 5mg/5ml (1mg/ml):</strong> ${(doseMg / 1).toFixed(1)} ml</p>
                    </div>
                `;
                if (weight >= 15) {
                    const comp10 = Math.round(doseMg / 10 * 2) / 2;
                    alternatives += `
                        <div style="background: #fef3c7; border: 1px solid #fcd34d; padding: 8px; border-radius: 4px; margin-bottom: 6px;">
                            <p style="font-size: 12px; color: #92400e; margin: 0;"><strong>Comprimidos 10mg:</strong> ${comp10} comp.</p>
                        </div>
                    `;
                }
            }

            if (medicationKey === 'salbutamol') {
                // Presentaciones alternativas
                alternatives += `
                    <div style="background: #ecfdf5; border: 1px solid #6ee7b7; padding: 8px; border-radius: 4px; margin-bottom: 6px;">
                        <p style="font-size: 12px; color: #047857; margin: 0;"><strong>Jarabe 1mg/5ml:</strong> ${(doseMg / 0.2).toFixed(1)} ml</p>
                    </div>
                `;
                if (weight >= 15) {
                    const comp2 = Math.round(doseMg / 2 * 2) / 2;
                    const comp4 = Math.round(doseMg / 4 * 2) / 2;
                    alternatives += `
                        <div style="background: #ecfdf5; border: 1px solid #6ee7b7; padding: 8px; border-radius: 4px; margin-bottom: 6px;">
                            <p style="font-size: 12px; color: #047857; margin: 0;"><strong>Comprimidos 2mg:</strong> ${comp2} comp.</p>
                        </div>
                        <div style="background: #ecfdf5; border: 1px solid #6ee7b7; padding: 8px; border-radius: 4px; margin-bottom: 6px;">
                            <p style="font-size: 12px; color: #047857; margin: 0;"><strong>Comprimidos 4mg:</strong> ${comp4} comp.</p>
                        </div>
                    `;
                }
            }

            if (medicationKey === 'prednisolona') {
                // Presentaciones alternativas
                alternatives += `
                    <div style="background: #fdf2f8; border: 1px solid #f9a8d4; padding: 8px; border-radius: 4px; margin-bottom: 6px;">
                        <p style="font-size: 12px; color: #be185d; margin: 0;"><strong>Jarabe 5mg/5ml (1mg/ml):</strong> ${(doseMg / 1).toFixed(1)} ml</p>
                    </div>
                `;
                if (weight >= 15) {
                    const comp5 = Math.round(doseMg / 5 * 2) / 2;
                    const comp20 = Math.round(doseMg / 20 * 2) / 2;
                    alternatives += `
                        <div style="background: #fdf2f8; border: 1px solid #f9a8d4; padding: 8px; border-radius: 4px; margin-bottom: 6px;">
                            <p style="font-size: 12px; color: #be185d; margin: 0;"><strong>Comprimidos 5mg:</strong> ${comp5} comp.</p>
                        </div>
                        <div style="background: #fdf2f8; border: 1px solid #f9a8d4; padding: 8px; border-radius: 4px; margin-bottom: 6px;">
                            <p style="font-size: 12px; color: #be185d; margin: 0;"><strong>Comprimidos 20mg:</strong> ${comp20} comp.</p>
                        </div>
                    `;
                }
            }
            
            return alternatives;
        }

        // Update calculations
        function updateCalculations() {
            const weight = parseFloat(document.getElementById('weight').value);
            const selectedMed = document.getElementById('medication').value;
            
            // Update selected medication calculation FIRST
            if (weight && selectedMed && medications[selectedMed]) {
                const medication = medications[selectedMed];
                const result = medication.calculate(weight);
                
                document.getElementById('results-card').classList.remove('hidden');
                document.getElementById('selected-med-name').textContent = medication.name;
                document.getElementById('calculated-mg').textContent = result.mg + ' mg';
                document.getElementById('calculated-ml').textContent = result.ml + ' ml';
                
                // Update medication details
                const detailsHTML = `
                    <div style="margin-top: 16px; display: grid; grid-template-columns: 1fr 1fr; gap: 8px; font-size: 14px;">
                        <p><strong>Categor√≠a:</strong> ${medication.category}</p>
                        <p><strong>Frecuencia:</strong> ${medication.frequency}</p>
                        <p><strong>Presentaci√≥n:</strong> ${medication.presentation}</p>
                        <p><strong>Dosis general:</strong> ${medication.dose}</p>
                        <p style="grid-column: span 2;"><strong>Dosis m√°xima:</strong> ${medication.maxDose}</p>
                    </div>
                `;
                document.getElementById('medication-details').innerHTML = detailsHTML;
                
                // Update warnings
                let warningsHTML = '';
                if (medication.contraindications) {
                    warningsHTML += `
                        <div class="warning-card">
                            <div class="warning-title">‚ö†Ô∏è Contraindicaciones</div>
                            <div class="warning-text">${medication.contraindications}</div>
                        </div>
                    `;
                }
                if (medication.warnings) {
                    warningsHTML += `
                        <div class="info-card">
                            <div class="warning-title">‚ÑπÔ∏è Precauciones</div>
                            <div class="warning-text">${medication.warnings}</div>
                        </div>
                    `;
                }
                document.getElementById('medication-warnings').innerHTML = warningsHTML;
            } else {
                document.getElementById('results-card').classList.add('hidden');
            }

            // Update analgesics SECOND (complementary)
            if (weight && weight > 0) {
                document.getElementById('analgesics-card').classList.remove('hidden');
                
                // Paracetamol calculation (15 mg/kg/dosis)
                const paracetamolDoseMg = weight * 15;
                
                // Paracetamol jarabe 160mg/5ml = 32mg/ml
                const paracetamolJarabeMl = paracetamolDoseMg / 32;
                document.getElementById('paracetamol-jarabe-ml').textContent = paracetamolJarabeMl.toFixed(1);
                
                // Paracetamol gotas 100mg/ml
                const paracetamolGotasMl = paracetamolDoseMg / 100;
                document.getElementById('paracetamol-gotas-ml').textContent = paracetamolGotasMl.toFixed(1);
                
                // Ibuprofeno calculation (7 mg/kg/dosis)
                const ibuprofenoDoseMg = weight * 7;
                
                // Ibuprofeno jarabe 100mg/5ml = 20mg/ml
                const ibuprofenoJarabeMl = ibuprofenoDoseMg / 20;
                document.getElementById('ibuprofeno-jarabe-ml').textContent = ibuprofenoJarabeMl.toFixed(1);
                
                // Ibuprofeno concentrado 200mg/ml
                const ibuprofenoConcentradoMl = ibuprofenoDoseMg / 200;
                document.getElementById('ibuprofeno-concentrado-ml').textContent = ibuprofenoConcentradoMl.toFixed(1);
            } else {
                document.getElementById('analgesics-card').classList.add('hidden');
            }
        }

        // Populate medications grid
        function populateMedications() {
            const medicationsGrid = document.getElementById('medications-grid');
            let html = '';
            
            Object.entries(medications).forEach(([key, med]) => {
                html += `
                    <div class="medication-card">
                        <div class="medication-header">
                            <h3 class="medication-name">${med.name}</h3>
                            <span class="medication-category">${med.category}</span>
                        </div>
                        
                        <div style="margin-top: 12px; font-size: 14px; color: #6b7280; line-height: 1.4;">
                            <p><strong>Dosis:</strong> ${med.dose}</p>
                            <p><strong>Frecuencia:</strong> ${med.frequency}</p>
                            <p><strong>Presentaci√≥n:</strong> ${med.presentation}</p>
                            <p><strong>M√°ximo:</strong> ${med.maxDose}</p>
                        </div>

                        ${med.contraindications ? `
                            <div style="margin-top: 12px; padding: 8px; background: #fef2f2; border-radius: 4px; font-size: 12px; color: #b91c1c;">
                                <strong>Contraindicaciones:</strong> ${med.contraindications}
                            </div>
                        ` : ''}
                    </div>
                `;
            });
            
            medicationsGrid.innerHTML = html;
        }

        // Filter medications
        function filterMedications() {
            const searchTerm = document.getElementById('search-medication').value.toLowerCase();
            const medicationCards = document.querySelectorAll('#medications-grid .medication-card');
            
            medicationCards.forEach(card => {
                const text = card.textContent.toLowerCase();
                if (text.includes(searchTerm)) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        }

        // Scale functions
        function showScale(scaleId) {
            currentScale = scaleId;
            document.getElementById('scales-list').classList.add('hidden');
            document.getElementById('scale-evaluation').classList.remove('hidden');
            
            const scale = clinicalScales[scaleId];
            document.getElementById('max-score').textContent = scale.maxScore;
            
            renderScaleCategories(scaleId);
            updateScaleScore();
        }

        function backToScales() {
            document.getElementById('scales-list').classList.remove('hidden');
            document.getElementById('scale-evaluation').classList.add('hidden');
            currentScale = '';
        }

        function renderScaleCategories(scaleId) {
            const scale = clinicalScales[scaleId];
            const container = document.getElementById('scale-categories');
            let html = '';
            
            Object.entries(scale.categories).forEach(([categoryId, category]) => {
                html += `
                    <div style="border-left: 4px solid #2563eb; padding-left: 16px; margin-bottom: 24px;">
                        <h5 style="font-weight: 600; color: #374151; margin-bottom: 12px;">${category.name}</h5>
                        
                        <div style="display: flex; flex-direction: column; gap: 8px;">
                            ${category.items.map(item => `
                                <label class="scale-item" onclick="handleScaleItemClick('${categoryId}', '${item.id}', ${item.points})">
                                    <input type="radio" name="${categoryId}" value="${item.id}" style="margin-top: 4px;">
                                    <div class="scale-content">
                                        <div style="display: flex; justify-content: space-between; align-items: start;">
                                            <span class="scale-text">${item.text}</span>
                                            <span class="scale-points">${item.points} pts</span>
                                        </div>
                                    </div>
                                </label>
                            `).join('')}
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        function handleScaleItemClick(categoryId, itemId, points) {
            if (!scaleScores[currentScale]) scaleScores[currentScale] = {};
            scaleScores[currentScale][categoryId] = { [itemId]: points };
            
            // Update visual selection
            const categoryInputs = document.querySelectorAll(`input[name="${categoryId}"]`);
            categoryInputs.forEach(input => {
                const label = input.closest('.scale-item');
                if (input.value === itemId) {
                    input.checked = true;
                    label.classList.add('selected');
                } else {
                    input.checked = false;
                    label.classList.remove('selected');
                }
            });
            
            updateScaleScore();
        }

        function updateScaleScore() {
            if (!currentScale) return;
            
            const scores = scaleScores[currentScale] || {};
            let total = 0;
            
            Object.values(scores).forEach(categoryScores => {
                Object.values(categoryScores).forEach(points => {
                    total += points;
                });
            });
            
            document.getElementById('current-score').textContent = total;
            
            // El bot√≥n de copiar siempre est√° disponible
            const copyBtn = document.getElementById('copy-report-btn');
            copyBtn.disabled = false;
            copyBtn.style.opacity = '1';
            copyBtn.style.cursor = 'pointer';
            
            // Update interpretation
            if (total > 0) {
                const scale = clinicalScales[currentScale];
                const interpretation = scale.interpretation(total);
                
                document.getElementById('interpretation-result').innerHTML = `
                    <div class="interpretation ${interpretation.color}">
                        <div class="interpretation-level">${interpretation.level}</div>
                        <div class="interpretation-desc">${interpretation.description}</div>
                    </div>
                `;
            } else {
                document.getElementById('interpretation-result').innerHTML = '';
            }
        }

        function generateScaleReport() {
            if (!currentScale) return '';
            
            const scale = clinicalScales[currentScale];
            const totalScore = calculateTotalScore();
            const scores = scaleScores[currentScale] || {};
            
            let report = `=== ${scale.name.toUpperCase()} ===\n`;
            report += `Fecha: ${new Date().toLocaleDateString()}\n`;
            report += `Hora: ${new Date().toLocaleTimeString()}\n\n`;
            
            report += `EVALUACI√ìN:\n`;
            Object.entries(scale.categories).forEach(([categoryId, category]) => {
                report += `\n${category.name}:\n`;
                const categoryScores = scores[categoryId] || {};
                
                category.items.forEach(item => {
                    const isSelected = categoryScores[item.id] !== undefined;
                    report += `${isSelected ? '‚òë' : '‚òê'} ${item.text} (${item.points} puntos)\n`;
                });
            });
            
            report += `\n=== RESULTADO ===\n`;
            report += `Puntuaci√≥n Total: ${totalScore}/${scale.maxScore}\n`;
            
            if (totalScore > 0) {
                const interpretation = scale.interpretation(totalScore);
                report += `Nivel: ${interpretation.level}\n`;
                report += `Interpretaci√≥n: ${interpretation.description}\n\n`;
            } else {
                report += `Nivel: Pendiente de evaluaci√≥n\n`;
                report += `Interpretaci√≥n: Completar evaluaci√≥n para obtener resultado\n\n`;
            }
            
            report += `=== OBSERVACIONES ===\n`;
            report += `_________________________________\n`;
            report += `_________________________________\n`;
            report += `_________________________________\n\n`;
            
            report += `Evaluado por: ____________________\n`;
            report += `Firma: ____________________\n`;
            
            return report;
        }

        function calculateTotalScore() {
            if (!currentScale) return 0;
            
            const scores = scaleScores[currentScale] || {};
            let total = 0;
            
            Object.values(scores).forEach(categoryScores => {
                Object.values(categoryScores).forEach(points => {
                    total += points;
                });
            });
            
            return total;
        }

        async function copyScaleReport() {
            try {
                const report = generateScaleReport();
                await navigator.clipboard.writeText(report);
                alert('Reporte copiado al portapapeles ‚úÖ');
            } catch (err) {
                console.error('Error al copiar:', err);
                // Fallback
                const textArea = document.createElement('textarea');
                textArea.value = generateScaleReport();
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                alert('Reporte copiado al portapapeles ‚úÖ');
            }
        }

        function clearCurrentScale() {
            if (currentScale) {
                delete scaleScores[currentScale];
                renderScaleCategories(currentScale);
                updateScaleScore();
            }
        }

        // Advice functions
        function showAdvice(adviceId) {
            currentAdvice = adviceId;
            document.getElementById('advice-list').classList.add('hidden');
            document.getElementById('advice-content').classList.remove('hidden');
            
            const advice = parentalAdvice[adviceId];
            document.getElementById('advice-title').textContent = advice.title;
            document.getElementById('advice-text').textContent = advice.content;
        }

        function backToAdvice() {
            document.getElementById('advice-list').classList.remove('hidden');
            document.getElementById('advice-content').classList.add('hidden');
            currentAdvice = '';
        }

        function printAdvice(adviceId) {
            const advice = parentalAdvice[adviceId];
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <html>
                    <head>
                        <title>${advice.title}</title>
                        <style>
                            body { font-family: Arial, sans-serif; line-height: 1.6; margin: 40px; }
                            h1 { color: #2563eb; border-bottom: 2px solid #2563eb; }
                            h2 { color: #1e40af; margin-top: 25px; }
                            h3 { color: #1d4ed8; }
                            .warning { background: #fee2e2; border-left: 4px solid #dc2626; padding: 10px; margin: 10px 0; }
                            .info { background: #dbeafe; border-left: 4px solid #2563eb; padding: 10px; margin: 10px 0; }
                            ul, ol { margin-left: 20px; }
                            @media print { body { margin: 20px; } }
                        </style>
                    </head>
                    <body>
                        <div>${advice.content.replace(/\n/g, '<br>').replace(/### /g, '<h3>').replace(/## /g, '<h2>').replace(/# /g, '<h1>')}</div>
                        <hr style="margin-top: 40px;">
                        <p style="text-align: center; color: #666; font-size: 12px;">
                            Documento generado por Calculadora Pedi√°trica Avanzada - ${new Date().toLocaleDateString()}
                        </p>
                    </body>
                </html>
            `);
            printWindow.document.close();
            printWindow.print();
        }

        function printCurrentAdvice() {
            if (currentAdvice) {
                printAdvice(currentAdvice);
            }
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            populateMedications();
        });
    </script>
</body>
</html>
