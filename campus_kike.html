<!DOCTYPE html><html lang="es"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0"><meta http-equiv="Cache-Control" content="no-store"/><meta http-equiv="Pragma" content="no-cache"/><meta http-equiv="Expires" content="0"/><title>Campus OPE Kike - UMBRAMED</title><style>:root{--primary:#C41E3A;--dark:#8B0000;--bg:#f5f7fa;--panel:#ffffff;--text:#1a1a1a;--muted:#6b7280;--accent:#d97706;--good:#059669;--bad:#dc2626;}*{box-sizing:border-box;margin:0;padding:0;}body{font-family:system-ui,-apple-system,'Segoe UI',Roboto,Arial,sans-serif;background:linear-gradient(135deg,#f8fafc 0%,#e2e8f0 100%);color:var(--text);min-height:100vh;}header{background:#fff;border-bottom:3px solid var(--primary);padding:.9rem 1.2rem;display:flex;justify-content:space-between;align-items:center;gap:1rem;position:sticky;top:0;z-index:50;}header h1{margin:0;font-size:1.05rem;letter-spacing:.5px;font-weight:800;color:var(--primary);display:flex;align-items:center;gap:.5rem;}header nav a{color:var(--text);text-decoration:none;font-size:.75rem;font-weight:600;letter-spacing:.5px;padding:.45rem .75rem;border-radius:8px;transition:.2s;background:#f1f5f9;}header nav a:hover{background:#e2e8f0;color:var(--primary);}main{max-width:1180px;margin:1.5rem auto 3rem;padding:0 1rem;}h2.section{font-size:1.15rem;margin:2.2rem 0 1rem;font-weight:700;color:var(--primary);letter-spacing:.5px;}p.lead{color:var(--muted);font-size:.85rem;line-height:1.5;margin-top:.3rem;} .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:1.1rem;margin-top:1rem;} .card{background:var(--panel);border:2px solid #e5e7eb;border-radius:18px;padding:1.05rem 1.05rem 1.25rem;box-shadow:0 8px 24px -8px rgba(0,0,0,.12);display:flex;flex-direction:column;position:relative;} .card h3{margin:.2rem 0 .45rem;font-size:.95rem;display:flex;align-items:center;gap:.4rem;font-weight:700;color:#111;} .badge{background:var(--primary);color:#fff;font-size:.55rem;font-weight:700;padding:.3rem .55rem;border-radius:999px;letter-spacing:.5px;text-transform:uppercase;display:inline-block;} .card small{font-size:.65rem;font-weight:600;color:var(--muted);letter-spacing:.5px;display:block;margin-bottom:.55rem;} .card p{font-size:.7rem;line-height:1.35;color:var(--text);flex-grow:1;} button.action{background:linear-gradient(45deg,var(--primary),var(--dark));color:#fff;font-weight:600;font-size:.7rem;border:none;padding:.6rem .85rem;border-radius:10px;cursor:pointer;letter-spacing:.5px;display:inline-flex;align-items:center;gap:.4rem;box-shadow:0 4px 14px rgba(196,30,58,.35);} button.action.secondary{background:#1e293b;} button.action:hover{filter:brightness(1.08);} button.action:disabled{opacity:.4;cursor:not-allowed;box-shadow:none;} .stats-bar{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:.75rem;margin-top:1rem;} .stat{background:#fff;border:2px solid #e5e7eb;padding:.7rem .8rem;border-radius:14px;display:flex;flex-direction:column;gap:.25rem;} .stat span.label{font-size:.55rem;font-weight:700;letter-spacing:.6px;color:var(--muted);} .stat span.value{font-size:1.05rem;font-weight:800;color:var(--primary);} .locked{filter:grayscale(.7);position:relative;} .locked::after{content:'üîí';position:absolute;top:6px;right:10px;font-size:.9rem;} .test-area{background:#fff;border:2px solid #e5e7eb;margin-top:2rem;padding:1.25rem 1.25rem 2.2rem;border-radius:22px;box-shadow:0 14px 44px -12px rgba(0,0,0,.15);} .test-meta{display:flex;flex-wrap:wrap;gap:.6rem;font-size:.55rem;font-weight:600;letter-spacing:.6px;margin:0 0 1rem;color:var(--muted);} .question-stem{font-size:.9rem;font-weight:600;line-height:1.4;margin:0 0 .9rem;} .options{list-style:none;margin:0;padding:0;display:flex;flex-direction:column;gap:.55rem;} .options li{background:#f1f5f9;border:2px solid #dbe1e8;padding:.55rem .65rem;border-radius:10px;font-size:.72rem;font-weight:500;cursor:pointer;line-height:1.3;display:flex;align-items:flex-start;gap:.45rem;position:relative;transition:.15s;} .options li:hover{background:#e2e8f0;} .options li.selected{border-color:var(--primary);background:#fff;} .options li.correct{border-color:var(--good);background:#ecfdf5;} .options li.incorrect{border-color:var(--bad);background:#fef2f2;} .explanation{margin-top:.9rem;font-size:.7rem;line-height:1.4;background:#f8fafc;border:2px solid #e2e8f0;padding:.7rem .75rem;border-radius:12px;display:none;} .progress{height:8px;background:#e2e8f0;border-radius:6px;overflow:hidden;margin:0 0 1.2rem;} .progress div{height:100%;width:0;background:linear-gradient(90deg,var(--primary),var(--dark));transition:width .4s;} .results{display:grid;gap:1rem;margin-top:1.2rem;} .result-summary{background:#fff;padding:1.1rem 1.15rem;border:2px solid #e5e7eb;border-radius:18px;} .tag{background:#fee2e2;color:var(--bad);padding:.25rem .55rem;border-radius:40px;font-size:.55rem;font-weight:700;letter-spacing:.5px;} .tag.good{background:#d1fae5;color:var(--good);} .small-note{font-size:.6rem;color:var(--muted);margin-top:.4rem;} .hidden{display:none!important;} footer{margin:4rem 0 2rem;text-align:center;font-size:.6rem;color:var(--muted);} @media (max-width:640px){header{flex-direction:column;align-items:flex-start;} .grid{grid-template-columns:1fr;} header h1{font-size:.95rem;} .card{padding:1rem 1rem 1.2rem;}}</style></head><body><header><h1>üî• Campus OPE Kike</h1><nav><a href="index.html">Inicio</a><a href="herramientas.html">Herramientas</a><a href="academia.html">Academia</a><a href="#" id="loginGate">Login</a></nav></header><main><section id="gate" class="card" style="max-width:560px;margin:3rem auto 2rem;display:none;"><h3>üîê Acceso Restringido</h3><p style="font-size:.75rem;line-height:1.4;">Este campus est√° reservado a Kike. Usa tu login (alias <strong>kike</strong>) para continuar. Si no eres Kike, no tendr√°s acceso a los contenidos personalizados.</p><div style="display:flex;gap:.6rem;margin-top:.7rem;"><button class="action" onclick="showLogin()">Iniciar Sesi√≥n</button><button class="action secondary" onclick="location.href='herramientas.html'">Volver</button></div><div class="small-note">Autenticaci√≥n gestionada por sistema central UMBRAMED.</div></section><section id="dashboard" class="hidden"><h2 class="section">Panel Principal</h2><p class="lead">Resumen de progreso y acceso r√°pido a modos de estudio OPE 2025.</p><div class="stats-bar" id="statsBar"></div><div class="grid" style="margin-top:1.2rem;" id="modeCards"></div><h2 class="section">Banco de Preguntas</h2><div class="grid" id="categoryGrid"></div></section><section id="testRunner" class="hidden"></section></main><footer>&copy; 2025 UMBRAMED. Uso exclusivo formativo interno.</footer><script src="js/auth.js"></script><script>(()=>{"use strict";const session=()=>window.UmbraAuthCore?.getSession()||null;const isKike=()=>{const s=session();return !!s && s.email==='kike@umbramed.org';};const gate=document.getElementById('gate');const dash=document.getElementById('dashboard');const testRunner=document.getElementById('testRunner');const statsBar=document.getElementById('statsBar');const categoryGrid=document.getElementById('categoryGrid');const modeCards=document.getElementById('modeCards');const loginGate=document.getElementById('loginGate');loginGate.addEventListener('click',e=>{e.preventDefault();showLogin();});function ensureAccess(){if(!session()){gate.style.display='block';dash.classList.add('hidden');return}else if(!isKike()){gate.style.display='block';gate.querySelector('h3').textContent='‚õî Acceso Denegado';gate.querySelector('p').innerHTML='Tu usuario no est√° autorizado para este campus. Contacta con administraci√≥n si crees que es un error.';dash.classList.add('hidden');return}gate.style.display='none';dash.classList.remove('hidden');}window.addEventListener('umbramed:login',ensureAccess);window.addEventListener('umbramed:logout',ensureAccess);ensureAccess();/* Data */const QUESTION_URL='preguntas-ejemplo-ope-2025.json';let allQuestions=[];let answeredWrong=JSON.parse(localStorage.getItem('kike_wrong')||'[]');let stats={total:0,done:0,correct:0};const saveWrong=()=>localStorage.setItem('kike_wrong',JSON.stringify(answeredWrong.slice(-500)));function categorize(sourceKey){switch(sourceKey){case'pai-questions':return'PAI';case'historical-exams':return'Ex√°menes OPE';case'simulacros':return'Simulacros';default:return'Otros'}}function loadQuestions(){fetch(QUESTION_URL).then(r=>{if(!r.ok)throw new Error('HTTP '+r.status);return r.json()}).then(data=>{['pai-questions','historical-exams','simulacros'].forEach(k=>{(data[k]||[]).forEach(q=>{allQuestions.push({id:q.id,stem:q.question,options:q.options,correct:q.correct,explanation:q.explanation,group:categorize(k)});});});stats.total=allQuestions.length;renderStats();renderCategories();renderModes();}).catch(err=>{console.error(err);const warn=document.createElement('div');warn.style.cssText='background:#fff3cd;color:#92400e;padding:1rem 1.1rem;border:2px solid #fcd34d;border-radius:14px;font-size:.65rem;font-weight:600;margin:2rem auto;max-width:600px;';warn.textContent='‚ö†Ô∏è No se pudieron cargar las preguntas. Verifica el archivo '+QUESTION_URL;dash.prepend(warn);});}function renderStats(){statsBar.innerHTML=`<div class="stat"><span class="label">TOTAL PREGUNTAS</span><span class="value">${stats.total}</span></div><div class="stat"><span class="label">RESPONDIDAS</span><span class="value">${stats.done}</span></div><div class="stat"><span class="label">ACIERTOS</span><span class="value">${stats.correct}</span></div><div class="stat"><span class="label">FALLOS GUARDADOS</span><span class="value">${answeredWrong.length}</span></div>`;}function groups(){return[...new Set(allQuestions.map(q=>q.group))].sort();}function renderCategories(){categoryGrid.innerHTML=groups().map(g=>{const count=allQuestions.filter(q=>q.group===g).length;return `<div class="card"><small>${g.toUpperCase()}</small><h3>${g==='PAI'?'üìò':g==='Simulacros'?'‚è±Ô∏è':'üìú'} ${g}</h3><p>${count} preguntas registradas de la categor√≠a ${g}. Selecciona para practicar de forma focalizada.</p><button class="action" onclick="window.__kike.runCategory('${g}')">Practicar ${g}</button></div>`}).join('');}function renderModes(){modeCards.innerHTML=`<div class="card"><small>MODO R√ÅPIDO</small><h3>‚ö° Test R√°pido (10)</h3><p>Genera 10 preguntas aleatorias mezcladas de todas las fuentes para un repaso √°gil.</p><button class="action" onclick="window.__kike.startQuick()">Iniciar</button></div><div class="card"><small>SIMULACROS</small><h3>‚è±Ô∏è Simulacro Completo</h3><p>Incluye √∫nicamente los bloques marcados como Simulacros para experiencia real.</p><button class="action" onclick="window.__kike.startSimulacro()">Comenzar</button></div><div class="card"><small>REVISI√ìN</small><h3>üîÅ Repasar Fallos</h3><p>Repite √∫nicamente las preguntas que has fallado y guardado para reforzar.</p><button class="action" ${answeredWrong.length?"":"disabled"} onclick="window.__kike.reviewWrong()">Revisar</button><div class="small-note">Se guardan √∫ltimos 500 fallos.</div></div><div class="card"><small>FOCALIZADO</small><h3>üéØ Modo Categor√≠a</h3><p>Selecciona una categor√≠a concreta en el listado inferior para un estudio dirigido.</p><button class="action secondary" onclick="document.getElementById('categoryGrid').scrollIntoView({behavior:'smooth'})">Ver Categor√≠as</button></div>`;}function pickRandom(list,n){const arr=[...list];for(let i=arr.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[arr[i],arr[j]]=[arr[j],arr[i]];}return arr.slice(0,Math.min(n,arr.length));}function buildTest(title,questions){window.scrollTo({top:0,behavior:'smooth'});testRunner.classList.remove('hidden');dash.classList.add('hidden');testRunner.innerHTML='<div class="test-area" id="testArea"></div>';const state={title,questions,index:0,answers:[],finished:false,start:Date.now()};renderQuestion(state);}function renderQuestion(state){const q=state.questions[state.index];const area=document.getElementById('testArea');const progress=((state.index)/state.questions.length)*100;area.innerHTML=`<div class="progress"><div style="width:${progress}%"></div></div><div class="test-meta"><span>${state.title}</span><span>Pregunta ${state.index+1} / ${state.questions.length}</span></div><div class="question-stem">${q.stem}</div><ul class="options">${q.options.map((opt,i)=>`<li data-i="${i}"><strong>${String.fromCharCode(65+i)}.</strong> <span>${opt}</span></li>`).join('')}</ul><div class="explanation" id="expBox"></div><div style="margin-top:1rem;display:flex;gap:.6rem;flex-wrap:wrap;"><button class="action" id="nextBtn" disabled>Siguiente</button><button class="action secondary" onclick="window.__kike.cancelTest()">Salir</button></div><div class="small-note">Selecciona opci√≥n para ver explicaci√≥n.</div>`;area.querySelectorAll('.options li').forEach(li=>{li.addEventListener('click',()=>{if(state.finished)return;const sel=parseInt(li.dataset.i);if(area.querySelector('.options li.selected'))return;li.classList.add('selected');const correct=sel===q.correct;li.classList.add(correct?'correct':'incorrect');if(!correct){area.querySelectorAll('.options li')[q.correct].classList.add('correct');answeredWrong.push(q.id);saveWrong();}state.answers.push({id:q.id,sel,correct});stats.done++;if(correct)stats.correct++;renderStats();const exp=document.getElementById('expBox');exp.style.display='block';exp.innerHTML='<strong>Explicaci√≥n:</strong> '+q.explanation;document.getElementById('nextBtn').disabled=false;});});document.getElementById('nextBtn').addEventListener('click',()=>{if(state.index+1<state.questions.length){state.index++;renderQuestion(state);}else{finishTest(state);}});}function finishTest(state){state.finished=true;const correct=state.answers.filter(a=>a.correct).length;const percent=Math.round((correct/state.questions.length)*100);const timeSec=Math.round((Date.now()-state.start)/1000);const area=document.getElementById('testArea');area.innerHTML=`<div class="progress"><div style="width:100%"></div></div><div class="test-meta"><span>Finalizado</span><span>${state.title}</span></div><div class="result-summary"><h3 style="margin:0 0 .6rem;font-size:1rem;">Resultados</h3><p style="font-size:.75rem;margin:0 0 .8rem;">Has acertado <strong>${correct}</strong> de <strong>${state.questions.length}</strong> preguntas (<strong>${percent}%</strong>) en <strong>${timeSec}s</strong>.</p><div style="display:flex;gap:.4rem;flex-wrap:wrap;margin-bottom:.8rem;">${percent>=70?'<span class="tag good">OBJETIVO</span>':'<span class="tag">REVISAR</span>'}${state.questions.length>=40?'<span class="tag">SIMULACRO</span>':''}</div><button class="action" onclick="window.__kike.backToDash()">Volver al Panel</button><button class="action secondary" onclick="window.__kike.retrySame()">Repetir</button></div><div class="results"><h4 style="margin:.8rem 0 .4rem;font-size:.75rem;letter-spacing:.5px;color:var(--muted);">Detalle</h4>${state.questions.map((q,i)=>{const ans=state.answers[i];return `<div style=\"border:1px solid #e5e7eb;padding:.55rem .6rem;border-radius:10px;font-size:.65rem;line-height:1.3;background:#f8fafc;\"><strong>${i+1}.</strong> ${q.stem}<br><span style=\"color:${ans.correct?'var(--good)':'var(--bad)'};font-weight:600;\">${ans.correct?'Correcta ‚úÖ':'Incorrecta ‚ùå'} (${String.fromCharCode(65+q.correct)})</span></div>`}).join('')}</div>`;lastFinished=state;}let lastFinished=null;window.__kike={startQuick:()=>{buildTest('Test R√°pido',pickRandom(allQuestions,10));},startSimulacro:()=>{const sims=allQuestions.filter(q=>q.group==='Simulacros');if(!sims.length){alert('No hay preguntas de simulacros');return;}buildTest('Simulacro',sims);},reviewWrong:()=>{const set=answeredWrong.map(id=>allQuestions.find(q=>q.id===id)).filter(Boolean);if(!set.length){alert('No hay fallos guardados');return;}buildTest('Revisi√≥n de Fallos',pickRandom(set,Math.min(15,set.length)));},runCategory:g=>{const list=allQuestions.filter(q=>q.group===g);if(!list.length){alert('Sin preguntas en '+g);return;}buildTest('Categor√≠a '+g,pickRandom(list,Math.min(20,list.length)));},backToDash:()=>{testRunner.classList.add('hidden');dash.classList.remove('hidden');renderStats();renderModes();renderCategories();window.scrollTo({top:0,behavior:'smooth'});},retrySame:()=>{if(!lastFinished)return;buildTest(lastFinished.title,lastFinished.questions);},cancelTest:()=>{if(confirm('Cancelar test actual?'))window.__kike.backToDash();}};loadQuestions();})();</script><script src="js/versioning.js"></script></body></html>
