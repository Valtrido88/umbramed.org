<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medicamentos Sin Lactosa - UMBRAMED Medical Division</title>
    <!-- Eliminado Tailwind CDN: utilidades cr√≠ticas recreadas abajo para p√°gina auto-contenida -->
    <style>
        /* Mini utilidades sustituyendo Tailwind usado */
        .mx-auto{margin-left:auto;margin-right:auto}
        .my-4{margin-top:1rem;margin-bottom:1rem}
        .mt-8{margin-top:2rem}.mt-12{margin-top:3rem}
        .mb-4{margin-bottom:1rem}.mb-6{margin-bottom:1.5rem}.mb-8{margin-bottom:2rem}
        .py-2{padding-top:.5rem;padding-bottom:.5rem}.py-3{padding-top:.75rem;padding-bottom:.75rem}.py-4{padding-top:1rem;padding-bottom:1rem}.py-8{padding-top:2rem;padding-bottom:2rem}.py-12{padding-top:3rem;padding-bottom:3rem}.py-16{padding-top:4rem;padding-bottom:4rem}
        .px-4{padding-left:1rem;padding-right:1rem}.px-6{padding-left:1.5rem;padding-right:1.5rem}.px-8{padding-left:2rem;padding-right:2rem}
        .p-3{padding:.75rem}.p-4{padding:1rem}.p-6{padding:1.5rem}.p-8{padding:2rem}
        .text-center{text-align:center}
        .text-xs{font-size:.75rem}.text-sm{font-size:.875rem}.text-lg{font-size:1.125rem}.text-xl{font-size:1.25rem}.text-2xl{font-size:1.5rem}.text-3xl{font-size:1.875rem}.text-5xl{font-size:3rem}
        .font-bold{font-weight:700}.font-semibold{font-weight:600}.font-medium{font-weight:500}
        .uppercase{text-transform:uppercase}
        .tracking-wide{letter-spacing:.05em}
        .rounded{border-radius:.25rem}.rounded-lg{border-radius:.5rem}.rounded-xl{border-radius:.75rem}.rounded-2xl{border-radius:1rem}
        .shadow-sm{box-shadow:0 1px 2px rgba(0,0,0,.05)}.shadow-xl{box-shadow:0 10px 25px -5px rgba(0,0,0,.1),0 4px 6px -2px rgba(0,0,0,.05)}
        .border{border:1px solid #e5e7eb}.border-b{border-bottom:1px solid #e5e7eb}.border-gray-200{border-color:#e5e7eb}.border-red-200{border-color:#fecaca}
        .flex{display:flex}.grid{display:grid}
        .items-center{align-items:center}.justify-between{justify-content:space-between}.justify-center{justify-content:center}.gap-2{gap:.5rem}.gap-3{gap:.75rem}.gap-4{gap:1rem}.gap-6{gap:1.5rem}.gap-8{gap:2rem}
        .grid-cols-1{grid-template-columns:repeat(1,minmax(0,1fr))}
        .md\:grid-cols-2{grid-template-columns:repeat(1,minmax(0,1fr))}
        .md\:grid-cols-3{grid-template-columns:repeat(1,minmax(0,1fr))}
        .lg\:grid-cols-3{grid-template-columns:repeat(1,minmax(0,1fr))}
        @media (min-width:768px){.md\:grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.md\:grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}}
        @media (min-width:1024px){.lg\:grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}}
        .hidden{display:none}.block{display:block}
        .w-full{width:100%}
        .min-h-screen{min-height:100vh}
        .bg-white{background:#fff}.bg-gray-100{background:#f3f4f6}.bg-red-50{background:#fef2f2}
        .text-white{color:#fff}.text-gray-500{color:#6b7280}.text-gray-600{color:#4b5563}.text-gray-700{color:#374151}.text-gray-900{color:#111827}.text-red-600{color:#dc2626}.text-red-700{color:#b91c1c}
        .transition-colors{transition:color .2s,background-color .2s}
        .hover\:bg-gray-200:hover{background:#e5e7eb}.hover\:text-red-700:hover{color:#b91c1c}
        .cursor-pointer{cursor:pointer}
        .space-y-3 > * + *{margin-top:.75rem}.space-y-4 > * + *{margin-top:1rem}
        .max-w-6xl{max-width:72rem}.max-w-7xl{max-width:80rem}
        .mx-4{margin-left:1rem;margin-right:1rem}
        .inline-flex{display:inline-flex;align-items:center}
        .animate-pulse{animation:pulse 2s cubic-bezier(.4,0,.6,1) infinite}
        @keyframes pulse{50%{opacity:.5}}
        /* Fin utilidades */
        /* Paleta de colores UMBRAMED */
        :root {
            --umbramed-red: #C41E3A;
            --umbramed-red-dark: #A01729;
            --umbramed-red-light: #E63946;
            --umbramed-gray: #F8F9FA;
            --umbramed-text: #2D3436;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, var(--umbramed-red) 0%, var(--umbramed-red-dark) 100%);
        }
        
        .umbramed-red {
            color: var(--umbramed-red);
        }
        
        .bg-umbramed-red {
            background-color: var(--umbramed-red);
        }
        
        .border-umbramed-red {
            border-color: var(--umbramed-red);
        }
        
        .card-border {
            border-left: 4px solid var(--umbramed-red);
        }
        
        .fade-in {
            animation: fadeIn 0.4s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .hover-card {
            transition: all 0.3s ease;
        }
        
        .hover-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(196, 30, 58, 0.1);
        }
        
        .medical-input {
            border: 2px solid #E5E7EB;
            border-radius: 0.5rem;
            transition: all 0.3s ease;
        }
        
        .medical-input:focus {
            outline: none;
            border-color: var(--umbramed-red);
            box-shadow: 0 0 0 3px rgba(196, 30, 58, 0.1);
        }
        
        .medical-button {
            background: linear-gradient(135deg, var(--umbramed-red), var(--umbramed-red-dark));
            transition: all 0.3s ease;
        }
        
        .medical-button:hover {
            background: linear-gradient(135deg, var(--umbramed-red-dark), #8B1538);
            transform: translateY(-1px);
        }
        
        .stats-card {
            background: linear-gradient(135deg, #FFF 0%, var(--umbramed-gray) 100%);
        }
        
        .expanded-content {
            max-height: 0;
            overflow: hidden;
            transition: all 0.4s ease-out;
            opacity: 0;
        }
        
        .expanded-content.show {
            max-height: 300px;
            opacity: 1;
        }
        
        .info-box {
            background: linear-gradient(135deg, #FEF7F0 0%, #FED7D7 100%);
            border: 1px solid #F687B3;
        }
        
        .dna-pattern {
            background-image: url("data:image/svg+xml,%3Csvg width='40' height='40' viewBox='0 0 40 40' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='%23f687b3' fill-opacity='0.05'%3E%3Cpath d='M20 20c0 11.046-8.954 20-20 20v20h20c11.046 0 20-8.954 20-20s-8.954-20-20-20z'/%3E%3C/g%3E%3C/svg%3E");
        }
    </style>
</head>
<body class="min-h-screen bg-white">
    <script src="js/common.js"></script>
    <script>document.addEventListener('DOMContentLoaded',()=>UmbramedComponents.init('medicamentos'));</script>

    <!-- Hero Section -->
    <section class="dna-pattern py-16 border-2 border-red-200 rounded-lg mx-4 mt-8">
        <div class="max-w-6xl mx-auto text-center px-4">
            <h1 class="text-5xl font-bold text-gray-900 mb-4">
                Base de Datos de Medicamentos Sin Lactosa
            </h1>
            <p class="text-xl umbramed-red font-semibold uppercase tracking-wide mb-6">
                ADVANCED PHARMACEUTICAL DATABASE & CLINICAL TOOLS
            </p>
            <p class="text-lg text-gray-600 max-w-4xl mx-auto leading-relaxed">
                Accede a una base de datos completa de medicamentos verificados sin lactosa, dise√±ada para optimizar 
                la pr√°ctica m√©dica moderna y facilitar la prescripci√≥n segura en pacientes con intolerancia a la lactosa.
            </p>
        </div>
    </section>

    <!-- Informaci√≥n Educativa sobre Lactosa -->
    <section class="max-w-6xl mx-auto px-4 py-12">
        <div class="info-box rounded-2xl p-8 mb-8">
            <div class="text-center mb-8">
                <h2 class="text-3xl font-bold umbramed-red mb-4">
                    LACTOSA COMO EXCIPIENTE FARMAC√âUTICO
                </h2>
                <p class="text-lg text-gray-700">Informaci√≥n esencial para profesionales sanitarios</p>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-8">
                <div class="text-center">
                    <div class="bg-red-100 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-4">
                        <span class="text-3xl">üìä</span>
                    </div>
                    <h3 class="font-bold text-xl text-gray-800 mb-2">15-20%</h3>
                    <p class="text-gray-600">de los medicamentos comercializados contienen lactosa como excipiente</p>
                </div>
                
                <div class="text-center">
                    <div class="bg-red-100 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-4">
                        <span class="text-3xl">‚ö†Ô∏è</span>
                    </div>
                    <h3 class="font-bold text-xl text-gray-800 mb-2">Reacciones</h3>
                    <p class="text-gray-600">Pueden causar s√≠ntomas digestivos en pacientes con intolerancia a la lactosa</p>
                </div>
                
                <div class="text-center">
                    <div class="bg-red-100 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-4">
                        <span class="text-3xl">üéØ</span>
                    </div>
                    <h3 class="font-bold text-xl text-gray-800 mb-2">Soluci√≥n</h3>
                    <p class="text-gray-600">172 medicamentos verificados sin lactosa disponibles en nuestra base de datos</p>
                </div>
            </div>
            
            <div class="bg-white rounded-xl p-6 border border-red-200">
                <h4 class="font-semibold text-lg umbramed-red mb-3">¬øPor qu√© usar lactosa en medicamentos?</h4>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 text-sm text-gray-700">
                    <div>
                        <p class="mb-2"><strong>‚Ä¢ Excipiente ideal:</strong> Propiedades de flujo excelentes para la fabricaci√≥n</p>
                        <p class="mb-2"><strong>‚Ä¢ Estabilidad:</strong> Protege el principio activo de la degradaci√≥n</p>
                        <p><strong>‚Ä¢ Compactaci√≥n:</strong> Facilita la formaci√≥n de comprimidos</p>
                    </div>
                    <div>
                        <p class="mb-2"><strong>‚Ä¢ Disoluci√≥n:</strong> Se disuelve r√°pidamente en el tracto digestivo</p>
                        <p class="mb-2"><strong>‚Ä¢ Coste-efectiva:</strong> Excipiente econ√≥mico y ampliamente disponible</p>
                        <p><strong>‚Ä¢ Regulatoria:</strong> Aprobada por todas las agencias internacionales</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <div class="max-w-6xl mx-auto px-4 py-6">
        <!-- Secci√≥n de herramientas m√©dicas -->
        <div class="text-center mb-12">
            <h2 class="text-4xl font-bold umbramed-red mb-4">HERRAMIENTAS M√âDICAS</h2>
            <div class="w-24 h-1 bg-umbramed-red mx-auto mb-6"></div>
        </div>

        <!-- Panel de b√∫squeda -->
        <div class="bg-white rounded-2xl shadow-xl mb-8 fade-in">
            <div class="card-border p-8">
                <div class="flex items-center gap-3 mb-6">
                    <div class="bg-red-50 p-3 rounded-xl">
                        <span class="text-2xl text-red-600">üîç</span>
                    </div>
                    <div>
                        <h3 class="text-xl font-bold text-gray-800">B√∫squeda de Medicamentos Sin Lactosa</h3>
                        <p class="text-gray-600">Base de datos verificada profesionalmente</p>
                    </div>
                </div>
                
                <div class="space-y-6">
                    <!-- Campo de b√∫squeda -->
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-3">
                            Nombre del medicamento o principio activo
                        </label>
                        <input
                            type="text"
                            id="searchInput"
                            placeholder="Ej: Paracetamol, Ibuprofeno, Amoxicilina..."
                            class="w-full px-4 py-4 medical-input text-gray-900 text-lg"
                        />
                    </div>

                    <!-- Filtros -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-3">
                                Categor√≠a terap√©utica
                            </label>
                            <select id="categoryFilter" class="w-full px-4 py-4 medical-input text-gray-900">
                                <option value="">-- Seleccionar categor√≠a --</option>
                            </select>
                        </div>

                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-3">
                                Laboratorio farmac√©utico
                            </label>
                            <select id="labFilter" class="w-full px-4 py-4 medical-input text-gray-900">
                                <option value="">-- Seleccionar laboratorio --</option>
                            </select>
                        </div>
                    </div>

                    <!-- Botones de acci√≥n -->
                    <div class="flex flex-wrap gap-4">
                        <button id="searchBtn" class="medical-button text-white px-8 py-3 rounded-lg font-semibold">
                            üîç Buscar medicamentos
                        </button>
                        <button id="clearFilters" class="bg-gray-100 text-gray-700 px-6 py-3 rounded-lg font-semibold hover:bg-gray-200 transition-colors hidden">
                            ‚ú® Limpiar filtros
                        </button>
                        <button id="statsToggle" class="bg-red-50 text-red-700 px-6 py-3 rounded-lg font-semibold hover:bg-red-100 transition-colors">
                            üìä Ver estad√≠sticas
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Panel de estad√≠sticas -->
        <div id="statsPanel" class="bg-white rounded-2xl shadow-xl mb-8 hidden fade-in">
            <div class="card-border p-8">
                <div class="flex items-center gap-3 mb-6">
                    <div class="bg-red-50 p-3 rounded-xl">
                        <span class="text-2xl text-red-600">üìä</span>
                    </div>
                    <div>
                        <h3 class="text-xl font-bold text-gray-800">Estad√≠sticas de la Base de Datos</h3>
                        <p class="text-gray-600">An√°lisis completo de medicamentos verificados</p>
                    </div>
                </div>
                
                <div class="grid grid-cols-2 md:grid-cols-4 gap-6 mb-8">
                    <div class="stats-card p-6 rounded-xl text-center border border-red-100">
                        <div class="text-3xl text-red-600 mb-2">üíä</div>
                        <div id="statsMedicamentos" class="text-3xl font-bold text-gray-800">172</div>
                        <div class="text-sm text-gray-600">Medicamentos</div>
                    </div>
                    <div class="stats-card p-6 rounded-xl text-center border border-red-100">
                        <div class="text-3xl text-red-600 mb-2">üìã</div>
                        <div id="statsCategorias" class="text-3xl font-bold text-gray-800">17</div>
                        <div class="text-sm text-gray-600">Categor√≠as</div>
                    </div>
                    <div class="stats-card p-6 rounded-xl text-center border border-red-100">
                        <div class="text-3xl text-red-600 mb-2">üè¢</div>
                        <div id="statsLaboratorios" class="text-3xl font-bold text-gray-800">6</div>
                        <div class="text-sm text-gray-600">Laboratorios</div>
                    </div>
                    <div class="stats-card p-6 rounded-xl text-center border border-red-100">
                        <div class="text-3xl text-red-600 mb-2">üéØ</div>
                        <div id="statsResultados" class="text-3xl font-bold text-gray-800">172</div>
                        <div class="text-sm text-gray-600">Resultados</div>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="stats-card p-6 rounded-xl border border-red-100">
                        <h4 class="font-semibold text-gray-800 mb-4 flex items-center gap-2">
                            <span class="text-xl">üè≠</span>
                            Laboratorios Principales
                        </h4>
                        <div id="topLaboratorios" class="space-y-3"></div>
                    </div>

                    <div class="stats-card p-6 rounded-xl border border-red-100">
                        <h4 class="font-semibold text-gray-800 mb-4 flex items-center gap-2">
                            <span class="text-xl">üéØ</span>
                            Categor√≠as M√°s Representadas
                        </h4>
                        <div id="topCategorias" class="space-y-3"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Resultados -->
        <div class="bg-white rounded-2xl shadow-xl fade-in">
            <div class="card-border p-8">
                <div class="flex items-center justify-between mb-6">
                    <div class="flex items-center gap-3">
                        <div class="bg-red-50 p-3 rounded-xl">
                            <span class="text-2xl text-red-600">üéØ</span>
                        </div>
                        <div>
                            <h3 class="text-xl font-bold text-gray-800">Resultados de B√∫squeda</h3>
                            <p class="text-gray-600">
                                Se encontraron <span id="resultCount" class="font-bold umbramed-red">172</span> medicamentos sin lactosa verificados
                            </p>
                        </div>
                    </div>
                    <div class="flex gap-3">
                        <button id="gridView" class="medical-button text-white px-6 py-3 rounded-lg font-semibold">
                            üì± Tarjetas
                        </button>
                        <button id="listView" class="bg-gray-100 text-gray-700 px-6 py-3 rounded-lg font-semibold hover:bg-gray-200">
                            üìã Lista
                        </button>
                    </div>
                </div>

                <!-- Mensaje sin resultados -->
                <div id="noResults" class="text-center py-16 hidden">
                    <div class="text-6xl mb-6">üîç</div>
                    <h3 class="text-2xl font-bold text-gray-700 mb-3">No se encontraron medicamentos</h3>
                    <p class="text-gray-500 mb-6 max-w-md mx-auto">
                        Intenta ajustar los criterios de b√∫squeda o verifica la ortograf√≠a del medicamento
                    </p>
                    <button id="clearFiltersFromNoResults" class="medical-button text-white px-8 py-3 rounded-lg font-semibold">
                        Mostrar todos los medicamentos
                    </button>
                </div>

                <!-- Contenedor de resultados -->
                <div id="resultsContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
            </div>
        </div>

        <!-- Disclaimers m√©dicos -->
        <div class="mt-12 space-y-4 text-center text-sm text-gray-600">
            <div class="flex items-center justify-center gap-2">
                <span>‚ö†Ô∏è</span>
                <span>Esta herramienta es de apoyo cl√≠nico. Siempre verificar dosis y consultar con profesional sanitario.</span>
            </div>
            <div class="flex items-center justify-center gap-2">
                <span>üî¨</span>
                <span class="font-semibold">VERIFICAR SIEMPRE la composici√≥n exacta en el envase del medicamento antes de administrar.</span>
            </div>
            <div class="flex items-center justify-center gap-2">
                <span>üìä</span>
                <span>La informaci√≥n es herramienta de cribado - No sustituyen la evaluaci√≥n cl√≠nica completa.</span>
            </div>
            <div class="text-xs text-gray-500 mt-6">
                Basado en evidencia cient√≠fica actualizada 2024 ‚Ä¢ Desarrollado para profesionales de la salud
            </div>
        </div>
    </div>

    <script>
        // Variables globales
        let medicamentosData = [];
        let currentViewMode = 'grid';
        let expandedCard = null;
        let filteredData = [];

        // Elementos del DOM
        const searchInput = document.getElementById('searchInput');
        const categoryFilter = document.getElementById('categoryFilter');
        const labFilter = document.getElementById('labFilter');
        const clearFiltersBtn = document.getElementById('clearFilters');
        const clearFiltersFromNoResultsBtn = document.getElementById('clearFiltersFromNoResults');
        const statsToggle = document.getElementById('statsToggle');
        const statsPanel = document.getElementById('statsPanel');
        const gridViewBtn = document.getElementById('gridView');
        const listViewBtn = document.getElementById('listView');
        const resultsContainer = document.getElementById('resultsContainer');
        const noResults = document.getElementById('noResults');
        const resultCount = document.getElementById('resultCount');

        // Inicializar la aplicaci√≥n
        document.addEventListener('DOMContentLoaded', async function() {
            await loadMedicamentosData();
            populateFilters();
            renderMedicamentos();
            setupEventListeners();
            updateStats();
        });

        async function loadMedicamentosData() {
            try {
                const response = await fetch('data/medicamentos-sin-lactosa.json');
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                medicamentosData = await response.json();
                filteredData = [...medicamentosData];
            } catch (error) {
                console.error("Error al cargar los datos de medicamentos:", error);
                resultsContainer.innerHTML = `<p class="text-red-500 text-center col-span-full">Error al cargar la base de datos de medicamentos. Por favor, int√©ntelo de nuevo m√°s tarde.</p>`;
            }
        }

        function populateFilters() {
            const categories = [...new Set(medicamentosData.map(m => m.categoria))];
            const categoryCounts = {};
            categories.forEach(cat => {
                categoryCounts[cat] = medicamentosData.filter(m => m.categoria === cat).length;
            });

            categories.sort().forEach(category => {
                const option = document.createElement('option');
                option.value = category;
                option.textContent = `${category} (${categoryCounts[category]})`;
                categoryFilter.appendChild(option);
            });

            const labs = [...new Set(medicamentosData.map(m => m.laboratorio))];
            const labCounts = {};
            labs.forEach(lab => {
                labCounts[lab] = medicamentosData.filter(m => m.laboratorio === lab).length;
            });

            labs.sort().forEach(lab => {
                const option = document.createElement('option');
                option.value = lab;
                option.textContent = `${lab} (${labCounts[lab]})`;
                labFilter.appendChild(option);
            });
        }

        function setupEventListeners() {
            let searchTimeout;
            searchInput.addEventListener('input', function() {
                clearTimeout(searchTimeout);
                searchTimeout = setTimeout(filterMedicamentos, 300);
            });
            
            categoryFilter.addEventListener('change', filterMedicamentos);
            labFilter.addEventListener('change', filterMedicamentos);
            clearFiltersBtn.addEventListener('click', clearAllFilters);
            clearFiltersFromNoResultsBtn.addEventListener('click', clearAllFilters);
            statsToggle.addEventListener('click', toggleStats);
            gridViewBtn.addEventListener('click', () => changeViewMode('grid'));
            listViewBtn.addEventListener('click', () => changeViewMode('list'));
        }

        function filterMedicamentos() {
            const searchTerm = searchInput.value.toLowerCase();
            const selectedCategory = categoryFilter.value;
            const selectedLab = labFilter.value;

            filteredData = medicamentosData.filter(med => {
                const matchesSearch = !searchTerm || 
                    med.nombre.toLowerCase().includes(searchTerm) ||
                    med.principio_activo.toLowerCase().includes(searchTerm) ||
                    med.laboratorio.toLowerCase().includes(searchTerm);
                
                const matchesCategory = !selectedCategory || med.categoria === selectedCategory;
                const matchesLab = !selectedLab || med.laboratorio === selectedLab;
                
                return matchesSearch && matchesCategory && matchesLab;
            });

            renderMedicamentos();
            updateResultCount();
            updateClearButton();
            updateStats();
        }

        function clearAllFilters() {
            searchInput.value = '';
            categoryFilter.value = '';
            labFilter.value = '';
            filterMedicamentos();
        }

        function updateClearButton() {
            const hasFilters = searchInput.value || categoryFilter.value || labFilter.value;
            clearFiltersBtn.classList.toggle('hidden', !hasFilters);
        }

        function changeViewMode(mode) {
            currentViewMode = mode;
            
            if (mode === 'grid') {
                gridViewBtn.className = 'medical-button text-white px-6 py-3 rounded-lg font-semibold';
                listViewBtn.className = 'bg-gray-100 text-gray-700 px-6 py-3 rounded-lg font-semibold hover:bg-gray-200';
                resultsContainer.className = 'grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6';
            } else {
                gridViewBtn.className = 'bg-gray-100 text-gray-700 px-6 py-3 rounded-lg font-semibold hover:bg-gray-200';
                listViewBtn.className = 'medical-button text-white px-6 py-3 rounded-lg font-semibold';
                resultsContainer.className = 'space-y-4';
            }
            
            renderMedicamentos();
        }

        function renderMedicamentos() {
            if (filteredData.length === 0) {
                resultsContainer.innerHTML = '';
                noResults.classList.remove('hidden');
                return;
            }

            noResults.classList.add('hidden');
            resultsContainer.innerHTML = '';

            filteredData.forEach(med => {
                const card = createMedicamentoCard(med);
                resultsContainer.appendChild(card);
            });
        }

        function createMedicamentoCard(med) {
            const isListView = currentViewMode === 'list';
            const card = document.createElement('div');
            
            card.className = `bg-white border-2 border-gray-100 rounded-2xl hover-card transition-all duration-300 ${
                isListView ? 'p-5' : 'p-6'
            }`;
            card.style.borderLeft = `6px solid ${med.color}`;

            card.innerHTML = `
                <div class="flex items-start justify-between">
                    <div class="flex-1">
                        <div class="flex items-center gap-4 mb-4">
                            <span class="text-3xl">${med.icono}</span>
                            <span class="px-4 py-2 rounded-full text-sm font-bold text-white shadow-lg" style="background-color: ${med.color}">
                                ${med.categoria}
                            </span>
                        </div>
                        
                        <h4 class="font-bold text-gray-800 mb-4 leading-tight text-lg">
                            ${med.nombre}
                        </h4>
                        
                        <div class="space-y-3 text-sm">
                            <div class="flex items-center gap-3 bg-gray-50 rounded-lg p-3">
                                <span class="text-lg text-red-600">üß™</span>
                                <div>
                                    <span class="font-semibold text-gray-700">P.A.:</span>
                                    <span class="text-gray-600">${med.principio_activo}</span>
                                </div>
                            </div>
                            <div class="flex items-center gap-3 bg-gray-50 rounded-lg p-3">
                                <span class="text-lg text-red-600">üè¢</span>
                                <div>
                                    <span class="font-semibold text-gray-700">Lab.:</span>
                                    <span class="text-gray-600">${med.laboratorio}</span>
                                </div>
                            </div>
                            <div class="flex items-center gap-3 bg-gray-50 rounded-lg p-3">
                                <span class="text-lg text-red-600">üì¶</span>
                                <div>
                                    <span class="font-semibold text-gray-700">Pres.:</span>
                                    <span class="text-gray-600">${med.presentacion}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <button class="expand-btn ml-4 p-3 hover:bg-red-50 rounded-xl transition-all duration-200" data-id="${med.id}">
                        <span class="text-xl text-red-400">‚¨áÔ∏è</span>
                    </button>
                </div>

                <div class="expanded-content mt-6 pt-6 border-t-2 border-red-100" data-id="${med.id}">
                    <div class="bg-gradient-to-r from-green-50 to-blue-50 border-2 border-green-200 p-6 rounded-2xl">
                        <div class="flex items-center gap-3 text-green-800 font-bold mb-3">
                            <span class="text-3xl">‚úÖ</span>
                            <span class="text-lg">Medicamento Verificado Sin Lactosa</span>
                        </div>
                        <div class="bg-white bg-opacity-80 rounded-xl p-4">
                            <div class="text-green-700 space-y-2 text-sm">
                                <p><strong class="umbramed-red">üìã Fuente:</strong> 1aria.com - Documento profesional verificado</p>
                                <p><strong class="umbramed-red">üìÖ Verificado:</strong> Marzo 2023</p>
                                <p><strong class="umbramed-red">üîç Estado:</strong> Informaci√≥n actualizada y confiable</p>
                                <p><strong class="umbramed-red">‚ö†Ô∏è Recordatorio:</strong> Siempre verificar composici√≥n en el envase antes de administrar</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            const expandBtn = card.querySelector('.expand-btn');
            expandBtn.addEventListener('click', () => toggleExpand(med.id, expandBtn));

            return card;
        }

        function toggleExpand(medId, button) {
            const expandedContent = document.querySelector(`.expanded-content[data-id="${medId}"]`);
            const buttonIcon = button.querySelector('span');
            
            if (expandedCard === medId) {
                expandedContent.classList.remove('show');
                buttonIcon.textContent = '‚¨áÔ∏è';
                expandedCard = null;
            } else {
                if (expandedCard) {
                    const prevContent = document.querySelector(`.expanded-content[data-id="${expandedCard}"]`);
                    const prevBtn = document.querySelector(`.expand-btn[data-id="${expandedCard}"] span`);
                    if (prevContent) prevContent.classList.remove('show');
                    if (prevBtn) prevBtn.textContent = '‚¨áÔ∏è';
                }
                
                expandedContent.classList.add('show');
                buttonIcon.textContent = '‚¨ÜÔ∏è';
                expandedCard = medId;
            }
        }

        function updateResultCount() {
            resultCount.textContent = filteredData.length;
            document.getElementById('statsResultados').textContent = filteredData.length;
        }

        function toggleStats() {
            statsPanel.classList.toggle('hidden');
            if (!statsPanel.classList.contains('hidden')) {
                renderStats();
            }
        }

        function updateStats() {
            document.getElementById('statsResultados').textContent = filteredData.length;
            const totalCategories = [...new Set(medicamentosData.map(m => m.categoria))].length;
            const totalLabs = [...new Set(medicamentosData.map(m => m.laboratorio))].length;
            document.getElementById('statsCategorias').textContent = totalCategories;
            document.getElementById('statsLaboratorios').textContent = totalLabs;
        }

        function renderStats() {
            const labStats = {};
            medicamentosData.forEach(med => {
                labStats[med.laboratorio] = (labStats[med.laboratorio] || 0) + 1;
            });
            
            const topLabs = Object.entries(labStats).sort(([,a], [,b]) => b - a).slice(0, 5);
            document.getElementById('topLaboratorios').innerHTML = topLabs.map(([lab, count]) => `
                <div class="flex justify-between items-center p-3 bg-white rounded-xl border border-red-100 shadow-sm">
                    <span class="font-semibold text-gray-700">${lab}</span>
                    <span class="bg-umbramed-red text-white px-3 py-1 rounded-full text-sm">${count}</span>
                </div>
            `).join('');

            const catStats = {};
            medicamentosData.forEach(med => {
                catStats[med.categoria] = (catStats[med.categoria] || 0) + 1;
            });
            
            const topCats = Object.entries(catStats).sort(([,a], [,b]) => b - a).slice(0, 5);
            document.getElementById('topCategorias').innerHTML = topCats.map(([cat, count]) => `
                <div class="flex justify-between items-center p-3 bg-white rounded-xl border border-red-100 shadow-sm">
                    <span class="font-semibold text-gray-700">${cat}</span>
                    <span class="bg-umbramed-red text-white px-3 py-1 rounded-full text-sm">${count}</span>
                </div>
            `).join('');
        }
    </script>
    <script src="js/auth.js"></script>
</body>
</html>
</html>